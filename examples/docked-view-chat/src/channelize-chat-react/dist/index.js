module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=23)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("@babel/runtime/helpers/defineProperty")},function(e,t){e.exports=require("@babel/runtime/helpers/assertThisInitialized")},function(e,t){e.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/createClass")},function(e,t){e.exports=require("@babel/runtime/helpers/inherits")},function(e,t){e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("channelize-chat")},function(e,t){e.exports=require("react-redux")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("lodash/debounce")},function(e,t){e.exports=require("uuidv4")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("immer")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("@babel/runtime/helpers/extends")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("redux-thunk")},function(e,t){e.exports=require("sprintf-js")},function(e,t){e.exports=require("redux-logger")},function(e,t){e.exports=require("remote-redux-devtools")},function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),i=n(5),o=n.n(i),s=n(2),c=n.n(s),l=n(6),u=n.n(l),d=n(7),p=n.n(d),m=n(3),f=n.n(m),h=n(1),v=n.n(h),g=n(0),y=n.n(g),E=n(10),_="Chat",S="Deleted Member",C="This message was deleted",N="Send a message",b="Share photo & video",O="Share a document",I="Search",D="Suggested",w="More Users",A="File",M="You",R="Send",U={admin_group_create:"%s created group %s",admin_group_join:"%s joined",admin_group_add_members:"%s added %s",admin_group_remove_members:"%s removed %s",admin_group_leave:"%s left",admin_group_make_admin:"%s are now an admin",admin_group_change_title:"%s changed the title to %s",admin_group_change_photo:"%s changed group photo",admin_call_video_missed:"%s missed a video call from %s",admin_call_voice_missed:"%s missed a voice call from %s"},L={admin_call_rejected:"Call Rejected",admin_call_completed:"Call Completed",admin_call_not_answered:"Call Not Answered",admin_call_missed:"Missed Call"},k="https://cdn.channelize.io/apps/web-widget/1.0.0/images/launcher-icon.svg",T="https://cdn.channelize.io/apps/web-widget/1.0.0/images/avtar.png",j="https://cdn.channelize.io/apps/web-widget/1.0.0/images/group.png",x=function(e,t){e({type:"CONNECT_SUCCESS",payload:t})},F=function(e,t){e({type:"CONNECT_FAIL",payload:t})};var P=function(e){return function(t){t({type:"SET_ACTIVE_CONVERSATION",payload:e})}},G=function(e){return function(t){t({type:"SET_ACTIVE_USERID",payload:e})}},V=n(17),B=n.n(V),q=y.a.createContext({client:null}),z=q.Provider;function H(e){return W(q,e)}var W=function(e,t){var n=e,r=t,a=function(e){return y.a.createElement(n.Consumer,null,(function(t){return y.a.createElement(r,B()({},t,e))}))};return a.themePath=r.themePath,a.extraThemePaths=r.extraThemePaths,a.displayName=(a.displayName=r.displayName||r.name||"Component").replace("Base",""),a};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Q=function(e){u()(n,e);var t=Y(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"getContext",(function(){return{client:r.props.client}})),r.state={conversation:null,userId:null},r}return o()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.client,n=e.userId,r=e.accessToken;t.connected?this.props.setConnected(!0):this.props.chConnect(t,n,r)}},{key:"componentDidUpdate",value:function(e){this.props.connected&&!e.connected&&this.props.connected&&this.props.registerEventHandlers(this.props.client)}},{key:"render",value:function(){this.props.connected;return y.a.createElement(z,{value:this.getContext()},this.props.children)}}]),n}(g.PureComponent);function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Q=Object(E.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.client)}),{chConnect:function(e,t,n){return function(r){return r({type:"CONNECTING",payload:{}}),function(e,t,n){return new Promise((function(r,a){t?n?(e||a("Channelize.io client was not created."),e.connect(t,n,(function(e,t){e?a("Channelize.io connection Failed."):r(t)}))):a("accessToken is required."):a("UserID is required.")}))}(e,t,n).then((function(e){return x(r,e)})).catch((function(e){return F(r,e)}))}},registerEventHandlers:function(e){return function(t){e.chsocket.on("user.status_updated",(function(e){t({type:"USER_STATUS_UPDATED",payload:e})})),e.chsocket.on("user.updated",(function(e){t({type:"USER_UPDATED_EVENT",payload:e})})),e.chsocket.on("user.message_created",(function(e){t({type:"NEW_MESSAGE_RECEIVED_EVENT",payload:e})})),e.chsocket.on("user.joined",(function(n){var r=n.conversation;e.Conversation.getConversation(r.id,null,(function(e,r){e||(n.conversation=r,t({type:"USER_JOINED_EVENT",payload:n}))}))})),e.chsocket.on("conversation.members_added",(function(e){t({type:"MEMBERS_ADDED_EVENT",payload:e})})),e.chsocket.on("conversation.members_removed",(function(e){t({type:"MEMBERS_REMOVED_EVENT",payload:e})})),e.chsocket.on("conversation.updated",(function(e){t({type:"CONVERSATION_UPDATED_EVENT",payload:e})})),e.chsocket.on("conversation.mark_as_read",(function(e){t({type:"MARK_AS_READ_EVENT",payload:e})})),e.chsocket.on("conversation.typing",(function(e){t({type:"TYPING_EVENT",payload:e})})),e.chsocket.on("user.blocked",(function(e){t({type:"USER_BLOCKED_EVENT",payload:e})})),e.chsocket.on("user.unblocked",(function(e){t({type:"USER_UNBLOCKED_EVENT",payload:e})}))}},setConnected:function(){return function(e){e({type:"CONNECT_SUCCESS",payload:{}})}}})(Q);var X=function(e){u()(n,e);var t=J(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"toggleDropDownList",(function(){r.setState((function(e){return{showDropDownList:!e.showDropDownList}}))})),r.state={showDropDownList:!1},r}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.subtitle,r=e.profileImageUrl,a=e.showArrowBack,i=e.onBack,o=e.showChevron,s=e.renderDropDownList,c=e.renderRight,l=e.callButtons,u=this.state.showDropDownList;return y.a.createElement("div",{id:"ch_header",className:"ch-header"},a&&y.a.createElement("i",{className:"material-icons arrow-back",onClick:i},"arrow_back"),r&&y.a.createElement("div",{className:"ch-header-image",style:{backgroundImage:"url(".concat(r,")")}}),y.a.createElement("div",{className:"ch-header_details"},y.a.createElement("div",{className:"ch-header_content"},t&&y.a.createElement("div",{className:"ch-header-title"},y.a.createElement("div",null,t),o&&y.a.createElement("i",{className:"material-icons ch-chevron-icon",onClick:this.toggleDropDownList},"keyboard_arrow_down")),n&&y.a.createElement("div",{className:"ch-header-subtitle"},n),u&&s&&s()),l,y.a.createElement("div",{className:"ch-header_right-icons"},c&&this.props.renderRight())))}}]),n}(g.PureComponent);function Z(e){var t=e.onClick;return y.a.createElement("div",{id:"ch_launcher",className:"ch-launcher",onClick:t},y.a.createElement("img",{id:"ch_launcher_image",className:"ch-launcher-image",src:k,alt:""}))}function $(e){return y.a.createElement("div",{id:"ch_conv_loader_container"},y.a.createElement("div",{id:"ch_conv_loader",className:"ch-loader"}))}var ee=n(15),te=n(14),ne=n.n(te),re=n(20).sprintf;function ae(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length>1?arguments[1]:void 0;return Object(ee.produce)(n,(function(e){var n=t[r.type];return n?n(e,r):void 0}))}}function ie(e){return e.reduce((function(e,t){var n=e.map((function(e){return e.id}));return n.indexOf(t.id)<0?e.push(t):e.splice(n.indexOf(t.id),1,t),e}),[])}Object(ee.setAutoFreeze)(!1);var oe=function(e){if(e)return e.isGroup?e.profileImageUrl=e.profileImageUrl?e.profileImageUrl:j:e.user?(e.title=e.user.displayName,e.user.profileImageUrl?e.profileImageUrl=e.user.profileImageUrl:e.profileImageUrl=T):(e.title="Deleted User",e.profileImageUrl=T),e.otherMemberIds=[],e.members&&e.members.map((function(t){t.userId!=e._client.loginUser.id&&e.otherMemberIds.push(t.userId)})),e},se=function(e,t,n){var r,a=e.getCurrentUser();return n.forEach((function(e){a.id==e.ownerId&&(r=e)})),n.map((function(e,i){if(e.readByAll=null,e.showReadStatus=!1,r&&r.id==e.id&&(e.showReadStatus=!0,e.readByAll=!e.pending&&t.readByAllMembers(e)),"createdAt"in e||(e.createdAt=Date.now()),e.time=ue(e.createdAt),e.owner||(e.owner={id:a.id,displayName:a.displayName,profileImageUrl:a.profileImageUrl}),"profileImageUrl"in e.owner||(e.owner.profileImageUrl=T),"displayName"in e.owner&&(e.owner.displayName=he(e.owner.displayName)),e.isUser=!1,a.id==e.ownerId&&(e.isUser=!0),e.isDeleted&&(e.body="<i>"+C+"</i>"),i<n.length){var o=n[i+1];e.showOwnerAvatar=!1;var s=i==n.length-1&&a.id==e.owner.id;e.showOwnerAvatar=!(fe(e,o,a)||s||e.isUser);var c=n[i-1];e.showDateSeparator=!pe(e,c)}return"admin"==e.type&&(e.system=!0,e=ve(a,e)),e}))},ce=function(e,t){var n,r=e.getCurrentUser(),a=t.lastMessage;if(!Object.keys(a).length)return n="";if("admin"==a.type)return n="Admin message";var i,o=a.attachments;if(o&&o.length){var s=o[0];if(a.owner.id==r.id)n="You sent a ".concat(s.type);else{var c=he(a.owner.displayName);n="".concat(c," sent a ").concat(s.type)}return n}if(a.owner)if(a.owner.id==r.id)i="You: ";else if(t.isGroup){var l=he(a.owner.displayName);i="".concat(l,": ")}return a.isDeleted&&(a.body="This message was deleted."),n=i?"".concat(i).concat(a.body):"".concat(a.body)};function le(e){var t=new Date,n=t.getDate(),r=t.getMonth()+1,a=t.getFullYear(),i=new Date(e),o=i.getDate(),s=i.getMonth()+1,c=i.getFullYear(),l=c==a&&s==r&&n-o<=7;if(c==a&&s==r&&o==n)return ue(i);if(l){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][i.getDay()]}return s+"/"+o+"/"+c}function ue(e){var t=new Date(e),n=t.getHours(),r=n>=12?"PM":"AM";return(n=n%12||12)+":"+("0"+t.getMinutes()).substr(-2)+" "+r}function de(e){var t=new Date,n=t.getDate(),r=t.getMonth()+1,a=t.getFullYear(),i=new Date(e),o=i.getDate(),s=i.getMonth()+1,c=i.getFullYear();return c==a&&s==r&&n==o?"Today":c==a&&s==r&&n-o==1?"Yesterday":s+"/"+o+"/"+c}function pe(e,t){if(!(e&&e.createdAt&&t&&t.createdAt))return!1;var n=new Date(e.createdAt),r=new Date(t.createdAt);return n.getDate()==r.getDate()}var me=function(e){if(!e.length)return null;if(1==(e=e.map((function(e){return he(e.displayName.trim().split(" ")[0])}))).length)return"".concat(e[0]," is typing...");if(2==e.length){var t=e[0];e[1];return"".concat(t," and {secondUser} are typing...")}if(e.length>2){var n=e.slice(0,-1).join(", ");e.slice(-1);return"".concat(n," and {lastuser} are typing...")}};function fe(e,t,n){return!(!(t&&t.owner&&e.owner)||n.id!==e.owner.id&&t.owner.id!==e.owner.id)}var he=function(e){if(e){for(var t=0,n=(e=e.split(" ")).length;t<n;t++)e[t]?e[t]=e[t][0].toUpperCase()+e[t].substr(1):e[t]=e[t];return e.join(" ")}},ve=function(e,t){if("admin"!=t.type)return t;var n=t.attachments;if(!n.length)return t;var r,a,i=n[0],o=i.metaData;if("voice"==o.type||"video"==o.type){var s=o.duration?" "+function(e){e=Number(e);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(t>0?t+"h ":"")+(n>0?n+"m ":"")+(r>0?r+"s ":"")}(o.duration):"";return t.text=L[i.adminMessageType]+s,t}"user"==o.subType&&(r=e.id==o.subId?M:o.subUser?he(o.subUser.displayName):S);o.objType;var c=o.objValues;if("user"==o.objType)a=o.objUsers?e.id==o.objUsers.id?M:he(o.objUsers.displayName):S;else if("users"==o.objType&&Array.isArray(c)){var l=[];c.forEach((function(e){var t,n=o.objUsers.find((function(t){return t&&t.id==e}));t=n?he(n.displayName):S,l.push(t)})),a=l.join(", ")}else"group"==o.objType&&(a="string"==typeof c?he(c):c);var u=U[i.adminMessageType];return u&&(t.text=re(u,r,a)),t};function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Ee=function(e){u()(n,e);var t=ye(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"selectConversation",(function(){var e=r.props,t=e.conversation,n=e.onSelect;r.props.setActiveConversation(t),n&&"function"==typeof n&&n(t)})),r}return o()(n,[{key:"render",value:function(){var e,t=this.props,n=t.client,r=t.activeConversation,a=t.conversation,i=a.lastMessage,o=ce(n,a);i.createdAt?i.time=le(i.updatedAt):i.time=le(Date()),a.user&&a.user.isOnline&&(e=y.a.createElement("span",{className:"ch-online-icon ch-show-element"}));var s={};return r&&r.id==a.id&&(s={backgroundColor:"#fafafa"}),y.a.createElement("li",{style:s,id:a.id,onClick:this.selectConversation},y.a.createElement("div",{className:"ch-conversation-image",style:{backgroundImage:"url(".concat(a.profileImageUrl,")")}},e),y.a.createElement("div",{className:"ch-conversation-content"},y.a.createElement("div",{className:"ch-conversation-content__upper"},y.a.createElement("div",{id:"ch_title"},a.title),y.a.createElement("div",{id:"ch_created_at",className:"ch-created-at"},i.time)),y.a.createElement("div",{className:"ch-conversation-content__lower"},y.a.createElement("div",{id:"ch_last_msg_box",className:"ch-last-msg-box"},y.a.createElement("div",{className:"ch-last-message"},o)))))}}]),n}(g.PureComponent);Ee=H(Ee);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Ee=Object(E.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.conversation)}),{setActiveConversation:P})(Ee);var Ne=function(e){u()(n,e);var t=Ce(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"_init",(function(){var e=r.props,t=e.client;if(!e.list.length){var n=t.Conversation.createConversationListQuery();n.limit=r.limit,n.skip=r.skip,n.include="members",r.props.getConversationList(n)}})),v()(c()(r),"onCloseIconClick",(function(){var e=r.props.onCloseIconClick;e&&"function"==typeof e&&e()})),v()(c()(r),"onSearchIconClick",(function(){var e=r.props.onSearchIconClick;e&&"function"==typeof e&&e()})),r.limit=25,r.skip=0,r.onScroll=r.onScroll.bind(c()(r)),r.chRecentListingRef=y.a.createRef(),r}return o()(n,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=(t.client,t.connected),r=t.activeConversation,a=t.list;n&&(!e.connected&&this.props.connected&&this._init(),!r&&a.length&&this.props.setActiveConversation(a[0]))}},{key:"onScroll",value:function(){var e=this.props,t=e.list,n=e.client,r=e.loadingMoreConversations,a=e.allConversationsLoaded,i=this.chRecentListingRef.current;if(!(r||a||t.length<this.limit)&&i.scrollTop+i.clientHeight==i.scrollHeight){this.skip=t.length;var o=n.Conversation.createConversationListQuery();o.limit=this.limit,o.skip=this.skip,this.props.loadMoreConversations(o)}}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.client,a=n.list,i=n.connecting,o=n.connected,s=n.loading,c=n.error,l=n.loadingMoreConversations,u=n.showSearchIcon,d=(n.onSearchIconClick,n.showCloseIcon),p=n.activeConversation,m=n.onSelect,f=r.getCurrentUser();return e=f&&f.profileImageUrl?f.profileImageUrl:T,a=a.map((function(e){return oe(e)})),y.a.createElement("div",{id:"ch_recent_window",className:"ch-recent-window"},y.a.createElement(X,{profileImageUrl:e,title:_,renderRight:function(){return y.a.createElement("div",null,u&&y.a.createElement("i",{title:"Search",className:"material-icons",onClick:t.onSearchIconClick},"search"),d&&y.a.createElement("i",{title:"Close",className:"material-icons",onClick:t.onCloseIconClick},"close"))}}),y.a.createElement("div",{id:"ch_recent_listing",className:"ch-recent-listing",ref:this.chRecentListingRef,onScroll:this.onScroll},(i||s)&&y.a.createElement("div",{className:"center"},y.a.createElement($,null)),c&&y.a.createElement("div",{className:"center error"},c),o&&!a.length&&!s&&y.a.createElement("div",{className:"center no-record-found"},"No record Found"),y.a.createElement("ul",{id:"ch_recent_ul",className:"ch-recent-ul"},a.map((function(e){return y.a.createElement(Ee,{key:e.id,activeConversation:p,conversation:e,onSelect:m})}))),l&&y.a.createElement("div",null," Loading... ")))}}]),n}(g.PureComponent);Ne=H(Ne);function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Ne=Object(E.connect)((function(e){var t=e.conversation,n=e.client,r=e.message;return Se(Se(Se({},t),n),{},{activeConversation:r.conversation})}),{getConversationList:function(e){return function(t){return t({type:"LOADING_CONVERSATION_LIST",payload:{}}),e.list((function(e,n){e&&t({type:"CONVERSATION_LIST_FAIL",payload:e}),t({type:"CONVERSATION_LIST_SUCCESS",payload:n})}))}},loadMoreConversations:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_CONVERSATIONS",payload:{}}),e.list((function(e,n){e&&t({type:"LOAD_MORE_CONVERSATIONS_FAIL",payload:e}),t({type:"LOAD_MORE_CONVERSATIONS_SUCCESS",payload:n})}))}},setActiveConversation:P})(Ne);var Oe=function(e){u()(n,e);var t=be(n);function n(){return a()(this,n),t.apply(this,arguments)}return o()(n,[{key:"downloadFile",value:function(e,t){t=t||A;var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e=this,t=this.props.file,n=t.fileUrl?t.fileUrl:t.thumbnailUrl;return y.a.createElement("div",{className:"ch-light-box-container"},y.a.createElement("div",null,y.a.createElement("i",{title:"Close",className:"material-icons ch-close-light-box-icon",onClick:this.props.onCloseClick},"close"),y.a.createElement("i",{title:"Download",className:"material-icons ch-close-light-box-icon",onClick:function(){return e.downloadFile(n,t.name)}},"arrow_downward")),"image"==t.type&&y.a.createElement("img",{className:"ch-light-box-file",src:n}),"video"==t.type&&y.a.createElement("video",{controls:!0,id:"videoPlayer",className:"ch-light-box-file",preload:"auto",loop:"loop",autoPlay:"autoplay"},y.a.createElement("source",{src:n})))}}]),n}(g.PureComponent);function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var De=function(e){u()(n,e);var t=Ie(n);function n(e){return a()(this,n),t.call(this,e)}return o()(n,[{key:"downloadFile",value:function(e,t){var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.client,a=n.message,i=(r.getCurrentUser(),a.isUser?"right":"left"),o="admin"===a.type;a.attachments&&a.attachments.length&&(e=a.attachments.map((function(e){switch(e.type){case"image":return y.a.createElement("img",{key:a.id,className:"ch-image-message",src:e.thumbnailUrl?e.thumbnailUrl:e.fileUr,onClick:t.props.onClickEvent});case"video":return y.a.createElement("div",{key:a.id,className:"ch-video-container"},y.a.createElement("img",{className:"ch-image-message",src:e.thumbnailUrl,onClick:t.props.onClickEvent}),y.a.createElement("i",{className:"material-icons ch-video-play-icon",onClick:t.props.onClickEvent},"play_circle_outline"));case"application":var n=a.attachments[0].extension?a.attachments[0].extension:a.attachments[0].name.split(".").pop();return y.a.createElement("div",{key:a.id,className:"ch-text-message"},y.a.createElement("div",{className:"ch-message"},y.a.createElement("div",{className:"ch-message-body"},y.a.createElement("div",{className:"ch-docs-data"},y.a.createElement("i",{className:"material-icons ch-attachment-icon"},"description"),y.a.createElement("span",{className:"ch-docs-name"},e.name),e.fileUrl&&y.a.createElement("i",{className:"material-icons ch-docs-download-icon",onClick:function(){return t.downloadFile(e.fileUrl,e.name)}},"arrow_downward")),y.a.createElement("div",{className:"ch-docs-details"},y.a.createElement("hr",null),y.a.createElement("span",null,n)))));default:return null}})));var s=a.owner.profileImageUrl;return y.a.createElement(y.a.Fragment,null,a.showDateSeparator&&y.a.createElement("div",{key:"".concat(a.id,"-date"),className:"ch-msg-padding"},y.a.createElement("div",{className:"ch-message-date-separator"},y.a.createElement("div",{className:"message-date-separator_left"}),y.a.createElement("div",{className:"message-date-separator_text"},de(a.createdAt)),y.a.createElement("div",{className:"message-date-separator_right"}))),o?y.a.createElement("div",{className:"ch-admin-msg-container"},y.a.createElement("span",{className:"ch-admin-msg"},a.text)):y.a.createElement("div",{key:a.id,className:"ch-msg-padding ".concat(i)},y.a.createElement("div",{className:"ch-msg-container"},a.showOwnerAvatar&&y.a.createElement("div",{title:a.owner.displayName,className:"ch-message-owner-avatar",style:{backgroundImage:"url(".concat(s,")")}}),y.a.createElement("div",{className:"ch-msg-content ".concat("left"!=i||a.showOwnerAvatar?"":"padding-left")},a.body&&y.a.createElement("div",{className:"ch-text-message"},a.body),e,y.a.createElement("div",{className:"message-info"},y.a.createElement("span",{id:"ch_msg_time",className:"ch-msg-time"},a.time),a.showReadStatus&&a.readByAll&&y.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status ch-msg-read-status"},"done_all"),a.showReadStatus&&!a.pending&&!a.readByAll&&y.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status"},"done"),a.showReadStatus&&a.pending&&y.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status"},"schedule"))))))}}]),n}(g.Component);De=H(De);var we=n(13),Ae=n(16),Me=n.n(Ae),Re=n(12),Ue=n.n(Re),Le=n(18),ke=n.n(Le);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Fe=function(e){u()(n,e);var t=xe(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"_markAsRead",(function(e){e&&e.config.typing_events&&e.markAsRead()})),v()(c()(r),"_scrollToTarget",(function(e){if(r.chMessageBoxRef){var t=r.chMessageBoxRef.current;"[object Number]"!==Object.prototype.toString.call(e)?t.scrollTop=t.scrollHeight:t.scrollTop=e}})),v()(c()(r),"_init",(function(){var e=r.props,t=e.client,n=e.conversation,a=e.userId,i=e.ownProps;if(n||a){if(!n){r.setState({dummyConversation:null});var o=t.Conversation.createConversationListQuery();a&&(o.membersExactly=a,o.isGroup=!1),o.list((function(e,n){n.length?r.props.setActiveConversation(n[0]):t.User.get(a,(function(e,t){r.setState({dummyConversation:{isGroup:!1,user:t}})}))}))}if(n){r.props.registerConversationEventHandlers(n);var s=n.createMessageListQuery();s.limit=r.limit,r.skip=0,s.skip=r.skip,r.props.getMessageList(s),n.unreadMessageCount>0&&n.markAsRead()}}else if(Object.keys(i).length){if(i.conversation){var c=i.conversation;return"open"!=c.type||c.__isWatching?void r.props.setActiveConversation(c):void c.startWatching((function(e,t){r.props.setActiveConversation(c)}))}if(i.userId)return void r.props.setActiveUserId(i.userId)}})),v()(c()(r),"_onTextMessageChanged",(function(e){e&&r._startTyping(),r._stopTyping()})),v()(c()(r),"_startTyping",(function(){var e=r.props.conversation;e&&"private"==e.type&&e.startTyping()})),v()(c()(r),"_stopTyping",(function(){var e=r.props.conversation;e&&"private"==e.type&&e.stopTyping()})),v()(c()(r),"onCloseIconClick",(function(){r.props.setActiveConversation(null);var e=r.props.onCloseIconClick;e&&"function"==typeof e&&e()})),r.limit=25,r.skip=0,r.showMediaLightBox=!1,r.handleChange=r.handleChange.bind(c()(r)),r.handleKeyUp=r.handleKeyUp.bind(c()(r)),r.sendMessage=r.sendMessage.bind(c()(r)),r.onScroll=r.onScroll.bind(c()(r)),r._markAsRead=Me()(r._markAsRead,500),r.sendMedia=r.sendMedia.bind(c()(r)),r._startTyping=Me()(r._startTyping,3e3),r._stopTyping=Ue()(r._stopTyping,3e3),r.chMessageBoxRef=y.a.createRef(),r.state={text:"",dummyConversation:null,userId:null},r}return o()(n,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"getSnapshotBeforeUpdate",value:function(e){if(e.list.length<this.props.list.length){if(!this.chMessageBoxRef)return null;var t=this.chMessageBoxRef.current;return{scrollHeight:t.scrollHeight,offsetTop:t.scrollTop,offsetBottom:t.scrollHeight-t.scrollTop}}return null}},{key:"componentDidUpdate",value:function(e,t,n){var r=this,a=this.props,i=a.client,o=a.conversation,s=a.newMessage,c=a.userId;a.loadingMoreMessages;if(!e.connected&&this.props.connected&&this._init(),e.userId!=c&&c&&this._init(),!o&&e.sendingMessage&&!this.props.sendingMessage){this._scrollToTarget();var l=i.Conversation.createConversationListQuery();c&&(l.membersExactly=c,l.isGroup=!1),l.list((function(e,t){t.length?r.props.setActiveConversation(t[0]):i.User.get(c,(function(e,t){r.setState({dummyConversation:{isGroup:!1,user:t}})}))}))}if(o){if((!e.conversation&&o||e.conversation.id!=o.id)&&this._init(),e.loading&&!this.props.loading&&this._scrollToTarget(),!e.newMessage&&s||s&&e.newMessage.id!=s.id)this._scrollToTarget(),i.getCurrentUser().id!=s.ownerId&&this._markAsRead(o);if(e.list.length<this.props.list.length&&n){var u=this.chMessageBoxRef.current.scrollHeight-n.offsetBottom;this._scrollToTarget(u)}}}},{key:"handleChange",value:function(e){this.setState({text:e.target.value})}},{key:"handleKeyUp",value:function(e){if(13===e.keyCode)return e.preventDefault(),void this.sendMessage();this._onTextMessageChanged(e.target.value)}},{key:"sendFile",value:function(e){var t=this,n=this.props,r=n.client,a=n.conversation,i=r.getCurrentUser(),o=e.type.split("/").shift();if(e.type.match("application")){var s={id:Object(we.uuid)(),pending:!0,ownerId:i.id,attachments:[{type:o,name:e.name}]};this.props.sendFileToConversation(r,a,e,s,o)}else this.getFileThumbnailUrl(e,(function(n){var s={id:Object(we.uuid)(),pending:!0,ownerId:i.id,attachments:[{type:o,thumbnailUrl:n}]};e.type.match("video")&&(s.attachments[0].fileUrl=URL.createObjectURL(e)),t.props.sendFileToConversation(r,a,e,s,o)}))}},{key:"sendMessage",value:function(){var e=this.props,t=e.conversation,n=e.client,r=e.userId,a=n.getCurrentUser(),i=this.state.text,o={id:Object(we.uuid)(),body:i,ownerId:a.id,pending:!0};this.setState({text:""}),t?this.props.sendMessageToConversation(t,o):(o.userId=r,this.props.sendMessageToUserId(n,o))}},{key:"getFileThumbnailUrl",value:function(e,t){var n=new FileReader;e.type.match("image")?(n.onload=function(){document.createElement("img");t(n.result)},n.readAsDataURL(e)):e.type.match("video")&&(n.onload=function(){var r=new Blob([n.result],{type:e.type}),a=URL.createObjectURL(r),i=document.createElement("video"),o=function e(){s()&&(i.removeEventListener("timeupdate",e),i.pause())};i.addEventListener("loadeddata",(function(){s()&&i.removeEventListener("timeupdate",o)}));var s=function(){var e=document.createElement("canvas");e.width=i.videoWidth,e.height=i.videoHeight,e.getContext("2d").drawImage(i,0,0,e.width,e.height);var n=e.toDataURL(),r=n.length>1e5;r&&(document.createElement("img").src=n,t(n),URL.revokeObjectURL(a));return r};i.addEventListener("timeupdate",o),i.preload="metadata",i.src=a,i.muted=!0,i.playsInline=!0,i.play()},n.readAsArrayBuffer(e))}},{key:"onScroll",value:function(){var e=this.props,t=e.list,n=e.conversation,r=e.loadingMoreMessages,a=e.allMessagesLoaded;if(!n)return null;var i=this.chMessageBoxRef.current;if(!(r||a||t.length<this.limit)&&i.scrollTop<i.clientHeight){this.skip=t.length;var o=n.createMessageListQuery();o.limit=this.limit,o.skip=this.skip,this.props.loadMoreMessagesAction(o)}}},{key:"blockUser",value:function(){}},{key:"unblockUser",value:function(){}},{key:"sendMedia",value:function(e){this.sendFile(e.target.files[0]),e.target.value=null}},{key:"viewMediaToggle",value:function(e){var t=e?e.attachments[0]:null;this.setState({openMediaFile:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.client,r=t.connecting,a=t.connected,i=t.error,o=t.loading,s=t.loadingMoreMessages,c=t.list,l=t.conversation,u=t.showCloseIcon,d=t.showChevron,p=t.disableComposer,m=t.disableComposerMessage,f=t.Message,h=t.renderHeader,v=t.typing,g=this.state,E=g.text,_=g.dummyConversation;l||(l=_,c=[]),c=se(n,l,c);var S,C,I,D,w=!1;p&&"function"==typeof p&&(w=p(l)),l&&(C=(l=oe(l)).title,I=l.profileImageUrl,!l.isGroup&&l.user&&(D=l.user.isOnline?"Online":"Last Seen "+ne()(l.user.lastSeen).fromNow()),l.isGroup&&(D=l.memberCount+" Members"),S=l.isActive?y.a.createElement("div",{id:"ch_conv_block",onClick:function(){return e.blockUser()}},"Block User"):y.a.createElement("div",{id:"ch_conv_unblock",onClick:function(){return e.unblockUser()}},"Unblock User"));n.getCurrentUser();var A=me(v);return y.a.createElement("div",{id:"ch_conv_window",className:"ch-conv-window"},l&&h&&h(l),l&&!h&&y.a.createElement(X,{profileImageUrl:I,title:C,subtitle:D,showChevron:!(!d||!S),renderDropDownList:function(){if(S)return y.a.createElement("div",{className:"ch-drop-down-list"},S)},renderRight:function(){return y.a.createElement(y.a.Fragment,null,u&&y.a.createElement("i",{title:"Close",className:"material-icons",onClick:e.onCloseIconClick},"close"))}}),y.a.createElement("div",{id:"ch_messages_box",ref:this.chMessageBoxRef,className:"ch-messages-box",onScroll:this.onScroll},y.a.createElement("div",{className:"ch-conversation-padding"}," "),(r||o)&&y.a.createElement("div",{className:"center"},y.a.createElement($,null)),i&&y.a.createElement("div",{className:"center error"},i),y.a.createElement("div",{className:"ch-msg-list"},a&&!l&&y.a.createElement("div",{className:"center no-record-found"},"No conversation seleted"),s&&y.a.createElement($,null),l&&!c.length&&!o&&y.a.createElement("div",{className:"center no-record-found"},"No record Found"),c.map((function(t){return y.a.createElement(f,{key:t.id,message:t,onClickEvent:function(){return e.viewMediaToggle(t)}})})),y.a.createElement("div",{className:"ch-typing-strings"},A))),l&&y.a.createElement(y.a.Fragment,null,w?y.a.createElement("div",{className:"ch-composer-disabled-box"},y.a.createElement("div",null,m)):y.a.createElement("div",{id:"ch_send_box",className:"ch-send-box"},y.a.createElement("div",{className:"ch-media-icon-box"},y.a.createElement("i",{title:b,className:"material-icons ch-attachment-icon"},"insert_photo"),y.a.createElement("input",{id:"ch_gallary_input",title:b,className:"ch-gallary-input",type:"file",accept:"image/*, video/*",onChange:this.sendMedia})),y.a.createElement("div",{className:"ch-media-icon-box"},y.a.createElement("i",{title:O,className:"material-icons ch-attachment-icon"},"description"),y.a.createElement("input",{id:"ch_document_input",title:O,className:"ch-document-input",type:"file",accept:"application/*,.doc,.docx,.xls,.ppt",onChange:this.sendMedia})),y.a.createElement("textarea",{id:"ch_input_box",className:"ch-input-box",type:"text",placeholder:N,value:E,onChange:this.handleChange,onKeyUp:this.handleKeyUp}),y.a.createElement("button",{id:"ch_send_button",className:"ch-send-button",title:R,onClick:this.sendMessage},y.a.createElement("i",{className:"ch-send-icon material-icons"},"send")))),this.state.openMediaFile&&y.a.createElement(Oe,{file:this.state.openMediaFile,onCloseClick:function(){return e.viewMediaToggle(null)}}))}}]),n}(g.PureComponent);(Fe=H(Fe)).propTypes={Message:ke.a.elementType},Fe.defaultProps={Message:De};function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Fe=Object(E.connect)((function(e,t){var n=e.message,r=e.client;return je(je(je({},n),r),{},{ownProps:t})}),{getMessageList:function(e){return function(t){return t({type:"LOADING_MESSAGE_LIST",payload:{}}),e.list((function(e,n){t(e?{type:"MESSAGE_LIST_FAIL",payload:e}:{type:"MESSAGE_LIST_SUCCESS",payload:n.reverse()})}))}},sendMessageToConversation:function(e,t){return function(n){n({type:"SENDING_MESSAGE",payload:t});var r={id:t.id,body:t.body,attachments:t.attachments?t.attachments:[]};return e.sendMessage(r,(function(e,t){if(e)return r.error=e,void n({type:"SEND_MESSAGE_FAIL",payload:r});n({type:"SEND_MESSAGE_SUCCESS",payload:t})}))}},sendMessageToUserId:function(e,t){return function(n){return n({type:"SENDING_MESSAGE",payload:t}),e.Message.sendMessage(t,(function(e,t){e&&n({type:"SEND_MESSAGE_FAIL",payload:e}),n({type:"SEND_MESSAGE_SUCCESS",payload:t})}))}},sendFileToConversation:function(e,t,n,r,a){return function(i){i({type:"SENDING_FILE",payload:r});var o="application"!==a;e.File.upload(n,a,o,(function(e,n){if(e)return r.error=e,void i({type:"SEND_FILE_FAIL",payload:r});var a={};return a.id=r.id,a.attachments=[n],t.sendMessage(a,(function(e,t){if(e)return a.error=e,void i({type:"SEND_FILE_FAIL",payload:a});i({type:"SEND_FILE_SUCCESS",payload:t})}))}))}},loadMoreMessagesAction:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_MESSAGES",payload:{}}),e.list((function(e,n){t(e?{type:"LOAD_MORE_MESSAGES_FAIL",payload:e}:{type:"LOAD_MORE_MESSAGES_SUCCESS",payload:n.reverse()})}))}},setActiveConversation:P,setActiveUserId:G,registerConversationEventHandlers:function(e){return function(t){e.__isWatching&&e.on("watcher.message.created",(function(e){t({type:"NEW_MESSAGE_RECEIVED_EVENT",payload:e})}))}}})(Fe);var Ge=function(e){u()(n,e);var t=Pe(n);function n(e){return a()(this,n),t.call(this,e)}return o()(n,[{key:"showImage",value:function(e){var t=document.createElement("a");t.href=e,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"downloadFile",value:function(e,t){var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.client,r=t.message,a=(n.getCurrentUser(),r.attachments.map((function(t){switch(t.type){case"image":return y.a.createElement("img",{className:"ch-image-message",src:t.thumbnailUrl?t.thumbnailUrl:t.fileUr,onClick:function(){return e.showImage(t.fileUrl)}});case"video":return y.a.createElement("div",{className:"ch-video-container"},y.a.createElement("img",{className:"ch-image-message",src:t.thumbnailUrl,onClick:function(){return e.showImage(t.fileUrl)}}),y.a.createElement("i",{className:"material-icons ch-video-play-icon"},"play_circle_outline"));case"application":return y.a.createElement("div",{className:"ch-text-message"},y.a.createElement("div",{className:"ch-message-body"},y.a.createElement("div",{className:"ch-docs-data"},y.a.createElement("i",{className:"material-icons ch-attachment-icon"},"description"),y.a.createElement("span",{className:"ch-docs-name"},t.name),y.a.createElement("i",{className:"material-icons ch-docs-download-icon",onClick:function(){return e.downloadFile(t.fileUrl,t.name)}},"arrow_downward")),y.a.createElement("div",{className:"ch-docs-details"},y.a.createElement("hr",null),y.a.createElement("span",null,t.extension))));default:return null}}))),i=r.owner.profileImageUrl;return y.a.createElement(y.a.Fragment,null,r.showDateSeparator&&y.a.createElement("div",{key:"".concat(r.id,"-date"),className:"ch-msg-padding"},y.a.createElement("div",{className:"ch-message-date-separator"},y.a.createElement("div",{className:"message-date-separator_left"}),y.a.createElement("div",{className:"message-date-separator_text"},de(r.createdAt)),y.a.createElement("div",{className:"message-date-separator_right"}))),y.a.createElement("div",{key:r.id,className:"ch-msg-padding ".concat("left")},y.a.createElement("div",{className:"ch-msg-container"},y.a.createElement("div",{title:r.owner.displayName,className:"ch-message-owner-avatar",style:{backgroundImage:"url(".concat(i,")")}}),y.a.createElement("div",{className:"ch__message-livestream__owner-name"},r.owner.displayName),y.a.createElement("div",{className:"ch-msg-content"},r.body&&y.a.createElement("div",{className:"ch__message-livestream__text"},r.body),a))))}}]),n}(g.Component);function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Ge=H(Ge);var ze=function(e){u()(n,e);var t=qe(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"_init",(function(){var e=r.props.client.User.createUserListQuery();e.limit=r.friendsLimit,e.skip=0,e.sort="isOnline DESC, displayName ASC ",r.props.getFriendsList(e)})),v()(c()(r),"_searchOnServer",(function(e){var t=r.props.client,n=t.User.createUserListQuery();n.limit=r.searchLimit,n.skip=0,n.search=e,n.sort="isOnline DESC, displayName ASC",r.props.searchFriendsAction(n);var a=t.User.createUserListQuery();a.limit=r.searchLimit,a.skip=0,a.search=e,a.sort="isOnline DESC, displayName ASC",r.props.getMoreUsersList(a)})),v()(c()(r),"clearSearch",(function(){r.setState({searchText:""})})),v()(c()(r),"onContactClick",(function(e){var t=r.props.onContactClick;r.props.setActiveUserId(e),t&&"function"==typeof t&&t(e)})),r.searchLimit=10,r.friendsLimit=50,r.state={searchText:""},r.handleChange=r.handleChange.bind(c()(r)),r._searchOnServer=Ue()(r._searchOnServer,800),r}return o()(n,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=(t.client,t.connected);n&&!e.connected&&n&&this._init()}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({searchText:t}),t&&this._searchOnServer(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.connecting,r=t.connected,a=t.loadingFriendsList,i=t.loadingSearchFriends,o=t.friendslist,s=t.moreUsersList,c=t.searchFriends,l=t.showArrowBack,u=t.onBack,d=this.state.searchText,p=o;d?p=c:s=[];var m=!!s.length;return y.a.createElement("div",{id:"ch_search_window",className:"ch-search-window"},y.a.createElement(X,{showArrowBack:l,onBack:u,title:I}),y.a.createElement("div",{id:"ch_search_box",className:"ch-search-box"},y.a.createElement("input",{placeholder:"Search",id:"ch_search_input_box",className:"ch-search-input-box",value:d,onChange:this.handleChange}),d&&y.a.createElement("i",{id:"ch_clear_search_icon",className:"material-icons ch-clear-search-icon",onClick:this.clearSearch},"close")),y.a.createElement("div",{id:"ch_friends_box",className:"ch-friends-box"},(n||a)&&y.a.createElement("div",{className:"center"},y.a.createElement($,null)),i&&y.a.createElement("div",null,y.a.createElement($,null)),r&&d&&!p.length&&!m&&!a&&!i&&y.a.createElement("div",{className:"center no-record-found"},"No Record Found"),y.a.createElement("div",{id:"ch_suggested_box"},!d&&!a&&y.a.createElement("div",{id:"ch_suggested",className:"ch-suggested"},D),p.map((function(t){var n=t.profileImageUrl?t.profileImageUrl:T;return y.a.createElement("li",{key:t.id,id:t.id,className:"ch-friends-list",onClick:function(){return e.onContactClick(t.id)}},y.a.createElement("div",{className:"ch-contact-img",style:{backgroundImage:"url(".concat(n,")")}},t.isOnline&&y.a.createElement("span",{className:"ch-online-icon ch-show-element"})),y.a.createElement("div",{id:"ch_friend_name",className:"ch-friend-name"},t.displayName))}))),m&&y.a.createElement("div",{id:"ch_users_box"},y.a.createElement("div",{id:"ch_more_users",className:"ch-more-users"},w),s.map((function(t){var n=t.profileImageUrl?t.profileImageUrl:T;return y.a.createElement("li",{key:t.id,id:t.id,className:"ch-friends-list",onClick:function(){return e.onContactClick(t.id)}},y.a.createElement("div",{className:"ch-contact-img",style:{backgroundImage:"url(".concat(n,")")}},t.isOnline&&y.a.createElement("span",{className:"ch-online-icon ch-show-element"})),y.a.createElement("div",{id:"ch_friend_name",className:"ch-friend-name"},t.displayName))})))))}}]),n}(g.PureComponent);ze=H(ze);ze=Object(E.connect)((function(e){var t=e.user,n=e.client;return Be(Be({},t),n)}),{getFriendsList:function(e){return function(t){return t({type:"LOADING_FRIENDS_LIST",payload:{}}),e.friendsList((function(e,n){e&&t({type:"FRIENDS_LIST_FAIL",payload:e}),t({type:"FRIENDS_LIST_SUCCESS",payload:n})}))}},loadMoreFriends:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_FRIENDS",payload:{}}),e.friendsList((function(e,n){e&&t({type:"LOAD_MORE_FRIENDS_FAIL",payload:e}),t({type:"LOAD_MORE_FRIENDS_SUCCESS",payload:n})}))}},getMoreUsersList:function(e){return function(t){return t({type:"LOADING_MORE_USERS_LIST",payload:{}}),e.usersList((function(e,n){e&&t({type:"MORE_USERS_LIST_FAIL",payload:e}),t({type:"MORE_USERS_LIST_SUCCESS",payload:n})}))}},searchFriendsAction:function(e){return function(t){return t({type:"LOADING_SEARCH_FRIENDS",payload:{}}),e.friendsList((function(e,n){e&&t({type:"SEARCH_FRIENDS_FAIL",payload:e}),t({type:"SEARCH_FRIENDS_SUCCESS",payload:n})}))}},setActiveUserId:G})(ze);var He=n(11),We=n(19),Ke=n.n(We);n(21),n(22);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Je,Xe,Ze={connecting:!1,connected:!1,error:null},$e=n(8),et=n.n($e),tt=ae({list:[],loading:!1,loadingMoreConversations:!1,allConversationsLoaded:!1,error:null},(Je={},v()(Je,"LOADING_CONVERSATION_LIST",(function(e,t){e.loading=!0})),v()(Je,"CONVERSATION_LIST_FAIL",(function(e,t){e.loading=!1,e.error=t.payload})),v()(Je,"CONVERSATION_LIST_SUCCESS",(function(e,t){e.loading=!1,e.list=t.payload})),v()(Je,"LOADING_LOAD_MORE_CONVERSATIONS",(function(e,t){e.loadingMoreConversations=!0})),v()(Je,"LOAD_MORE_CONVERSATIONS_FAIL",(function(e,t){e.loadingMoreConversations=!1,e.error=t.payload})),v()(Je,"LOAD_MORE_CONVERSATIONS_SUCCESS",(function(e,t){e.loadingMoreConversations=!1,t.payload.length?(e.list=[].concat(et()(e.list),et()(t.payload)),e.list=ie(e.list)):e.allConversationsLoaded=!0})),v()(Je,"USER_STATUS_UPDATED",(function(e,t){var n=t.payload.user,r=e.list.map((function(e,t){return e.isGroup||e.user.id!=n.id||(e.user.isOnline=n.isOnline,e.user.lastSeen=n.lastSeen),e}));e.list=r})),v()(Je,"NEW_MESSAGE_RECEIVED_EVENT",(function(e,t){var n,r,a=t.payload.message,i=e.list.map((function(e,i){return e.id==a.conversationId?(e.lastMessage=a,e.updatedAt=t.payload.timestamp,n=i,r=e,e):e}));n>0&&(i.splice(n,1),i.unshift(r)),e.list=i})),v()(Je,"USER_JOINED_EVENT",(function(e,t){var n=t.payload.conversation;e.list=[n].concat(et()(e.list)),e.list=ie(e.list)})),v()(Je,"MEMBERS_ADDED_EVENT",(function(e,t){var n,r,a=t.payload,i=a.conversation,o=a.members,s=a.timestamp,c=e.list.map((function(e,t){return e.id==i.id?(e.memberCount=i.memberCount,e.updatedAt=s,e.members=e.members.concat(o),n=t,r=e,e):e}));n>0&&(c.splice(n,1),c.unshift(r)),e.list=c})),v()(Je,"MEMBERS_REMOVED_EVENT",(function(e,t){var n,r,a=t.payload,i=a.conversation,o=a.members,s=a.timestamp,c=e.list.map((function(e,t){return e.id==i.id?(e.memberCount=i.memberCount,e.updatedAt=s,o.forEach((function(t){var n=e.members.findIndex((function(e){return e.userId==t.id}));n>=0&&e.members.splice(n,1)})),n=t,r=e,e):e}));n>0&&(c.splice(n,1),c.unshift(r)),e.list=c})),v()(Je,"CONVERSATION_UPDATED_EVENT",(function(e,t){var n,r,a=t.payload.conversation,i=e.list.map((function(e,i){return e.id==a.id?(e.title=a.title,e.profileImageUrl=a.profileImageUrl,e.updatedAt=t.payload.timestamp,n=i,r=e,e):e}));n>0&&(i.splice(n,1),i.unshift(r)),e.list=i})),v()(Je,"USER_UPDATED_EVENT",(function(e,t){var n=t.payload.user,r=e.list.map((function(e,t){return e.isGroup||e.user.id!=n.id||(e.user.isOnline=n.isOnline,e.user.lastSeen=n.lastSeen,e.user.displayName=n.displayName,e.user.profileImageUrl=n.profileImageUrl),e}));e.list=r})),v()(Je,"MARK_AS_READ_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.user,i=n.timestamp,o=e.list.map((function(e,t){return e.id==r.id?(e.lastReadAt[a.id]&&(e.lastReadAt[a.id]=i),e):e}));e.list=o})),Je)),nt=n(9);function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function at(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var it,ot=ae({list:[],loading:!1,error:null,loadingMoreMessages:!1,allMessagesLoaded:!1,sendingMessage:!1,typing:[],conversation:null,userId:null,newMessage:null,sendingFile:!1},(Xe={},v()(Xe,"LOADING_MESSAGE_LIST",(function(e,t){e.loading=!0,e.list=[],e.allMessagesLoaded=!1})),v()(Xe,"MESSAGE_LIST_SUCCESS",(function(e,t){e.loading=!1,e.list=t.payload})),v()(Xe,"MESSAGE_LIST_FAIL",(function(e,t){e.loading=!1,e.error=t.payload})),v()(Xe,"SENDING_MESSAGE",(function(e,t){e.sendingMessage=!0,t.payload.status="pending",e.list=[].concat(et()(e.list),[t.payload]),e.list=ie(e.list)})),v()(Xe,"SEND_MESSAGE_SUCCESS",(function(e,t){e.sendingMessage=!1,e.list=[].concat(et()(e.list),[t.payload]),e.list=ie(e.list)})),v()(Xe,"SEND_MESSAGE_FAIL",(function(e,t){t.payload.status="failed"})),v()(Xe,"SENDING_FILE",(function(e,t){e.sendingFile=!0,e.list=[].concat(et()(e.list),[t.payload]),e.list=ie(e.list)})),v()(Xe,"SEND_FILE_FAIL",(function(e,t){e.sendingFile=!1})),v()(Xe,"SEND_FILE_SUCCESS",(function(e,t){e.sendingFile=!1,e.list=[].concat(et()(e.list),[t.payload]),e.list=ie(e.list)})),v()(Xe,"LOADING_LOAD_MORE_MESSAGES",(function(e,t){e.loadingMoreMessages=!0})),v()(Xe,"LOAD_MORE_MESSAGES_SUCCESS",(function(e,t){e.loadingMoreMessages=!1,t.payload.length?(e.list=[].concat(et()(t.payload),et()(e.list)),e.list=ie(e.list)):e.allMessagesLoaded=!0})),v()(Xe,"LOAD_MORE_MESSAGES_FAIL",(function(e,t){e.loadingMoreMessages=!1,e.error=t.payload})),v()(Xe,"SET_ACTIVE_CONVERSATION",(function(e,t){e.conversation=t.payload,e.userId=null})),v()(Xe,"SET_ACTIVE_USERID",(function(e,t){e.userId=t.payload,e.conversation=null})),v()(Xe,"CONVERSATION_UPDATED_EVENT",(function(e,t){var n=t.payload.conversation,r=n.id,a=n.title,i=n.profileImageUrl;if(e.conversation&&e.conversation.id==r){var o=at(at({},e.conversation.toJSON()),{},{title:a,profileImageUrl:i,updatedAt:t.payload.timestamp}),s=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(s,o)}})),v()(Xe,"MEMBERS_ADDED_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.members,i=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var o=e.conversation.toJSON();o.members=o.members.concat(a),o.memberCount=r.memberCount,o.updatedAt=i;var s=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(s,o)}})),v()(Xe,"MEMBERS_REMOVED_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.members,i=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var o=e.conversation.toJSON();o.memberCount=r.memberCount,o.updatedAt=i,a.forEach((function(e){var t=o.members.findIndex((function(t){return t.userId==e.id}));t>=0&&o.members.splice(t,1)}));var s=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(s,o)}})),v()(Xe,"NEW_MESSAGE_RECEIVED_EVENT",(function(e,t){var n=t.payload.message;e.conversation&&e.conversation.id==n.conversationId&&(e.list=[].concat(et()(e.list),[n]),e.list=ie(e.list),e.newMessage=n)})),v()(Xe,"USER_STATUS_UPDATED",(function(e,t){var n=t.payload.user;if(e.conversation&&!e.conversation.isGroup&&e.conversation.user.id==n.id){var r=e.conversation.toJSON();r.user.isOnline=n.isOnline,r.user.lastSeen=n.lastSeen;var a=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(a,r)}})),v()(Xe,"USER_UPDATED_EVENT",(function(e,t){var n=t.payload.user;if(e.conversation&&!e.conversation.isGroup&&e.conversation.user.id==n.id){var r=e.conversation.toJSON();r.user.isOnline=n.isOnline,r.user.lastSeen=n.lastSeen,r.user.displayName=n.displayName,r.user.profileImageUrl=n.profileImageUrl;var a=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(a,r)}})),v()(Xe,"MARK_AS_READ_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.user,i=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var o=e.conversation.toJSON();o.lastReadAt[a.id]&&(o.lastReadAt[a.id]=i);var s=nt.Channelize.core.Client.getInstance();e.conversation=new nt.Channelize.core.Conversation.Model(s,o)}})),v()(Xe,"TYPING_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.isTyping,i=n.user,o=e.conversation;if(o&&o.id==r.id){var s=e.typing.findIndex((function(e){return e.id==i.id}));a&&s<0?e.typing.push(i):!a&&s>=0&&e.typing.splice(s,1)}})),Xe)),st=ae({friendslist:[],loadingFriendsList:!1,error:null,loadingMoreFriends:!1,allFriendsLoaded:!1,moreUsersList:[],loadingMoreUsersList:!1,searchFriends:[],loadingSearchFriends:!1},(it={},v()(it,"LOADING_FRIENDS_LIST",(function(e,t){e.loadingFriendsList=!0,e.allFriendsLoaded=!1,e.friendslist=[]})),v()(it,"FRIENDS_LIST_SUCCESS",(function(e,t){e.loadingFriendsList=!1,e.friendslist=t.payload})),v()(it,"FRIENDS_LIST_FAIL",(function(e,t){e.loadingFriendsList=!1,e.error=t.payload})),v()(it,"LOADING_LOAD_MORE_FRIENDS",(function(e,t){e.loadingMoreFriends=!0})),v()(it,"LOAD_MORE_FRIENDS_SUCCESS",(function(e,t){e.loadingMoreFriends=!1,t.payload.length?(e.friendslist=[].concat(et()(e.friendslist),et()(t.payload)),e.friendslist=ie(e.friendslist)):e.allFriendsLoaded=!0})),v()(it,"LOAD_MORE_FRIENDS_FAIL",(function(e,t){e.loadingMoreFriends=!1,e.error=t.payload})),v()(it,"LOADING_MORE_USERS_LIST",(function(e,t){e.loadingMoreUsersList=!0,e.moreUsersList=[]})),v()(it,"MORE_USERS_LIST_SUCCESS",(function(e,t){e.loadingMoreUsersList=!1,e.moreUsersList=t.payload})),v()(it,"MORE_USERS_LIST_FAIL",(function(e,t){e.loadingMoreUsersList=!1,e.error=t.payload})),v()(it,"LOADING_SEARCH_FRIENDS",(function(e,t){e.loadingSearchFriends=!0,e.searchFriends=[]})),v()(it,"SEARCH_FRIENDS_SUCCESS",(function(e,t){e.loadingSearchFriends=!1,e.searchFriends=t.payload})),v()(it,"SEARCH_FRIENDS_FAIL",(function(e,t){e.loadingSearchFriends=!1,e.error=t.payload})),it)),ct=Object(He.combineReducers)({client:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECTING":return Qe(Qe({},e),{},{connecting:!0});case"CONNECT_SUCCESS":return Qe(Qe({},e),{},{connected:!0,connecting:!1});case"CONNECT_FAIL":return Qe(Qe({},e),{},{connected:!1,error:t.payload,connecting:!1});case"DISCONNECT_SUCCESS":return Qe(Qe({},e),{},{connected:!1});case"DISCONNECT_FAIL":return Qe(Qe({},e),{},{connected:!0,error:t.payload});default:return e}},conversation:tt,message:ot,user:st}),lt=[Ke.a];var ut=He.compose.apply(void 0,[He.applyMiddleware.apply(void 0,lt)].concat([])),dt=Object(He.createStore)(ct,{},ut);n.d(t,"App",(function(){return Q})),n.d(t,"Header",(function(){return X})),n.d(t,"Launcher",(function(){return Z})),n.d(t,"Loader",(function(){return $})),n.d(t,"ConversationList",(function(){return Ne})),n.d(t,"ConversationItem",(function(){return Ee})),n.d(t,"ConversationWindow",(function(){return Fe})),n.d(t,"MessageSimple",(function(){return De})),n.d(t,"MessageLivestream",(function(){return Ge})),n.d(t,"SearchWindow",(function(){return ze})),n.d(t,"createReducer",(function(){return ae})),n.d(t,"uniqueList",(function(){return ie})),n.d(t,"modifyConversation",(function(){return oe})),n.d(t,"modifyMessageList",(function(){return se})),n.d(t,"getLastMessageString",(function(){return ce})),n.d(t,"lastMessageTimeParser",(function(){return le})),n.d(t,"AMorPMTimeParser",(function(){return ue})),n.d(t,"dateSeparatorParser",(function(){return de})),n.d(t,"isSameDay",(function(){return pe})),n.d(t,"typingString",(function(){return me})),n.d(t,"isSameUser",(function(){return fe})),n.d(t,"capitalize",(function(){return he})),n.d(t,"ChannelizeContext",(function(){return q})),n.d(t,"ChannelizeProvider",(function(){return z})),n.d(t,"withChannelizeContext",(function(){return H})),n.d(t,"store",(function(){return dt}))}]);
//# sourceMappingURL=index.js.map