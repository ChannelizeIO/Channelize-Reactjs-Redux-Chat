module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("@babel/runtime/helpers/defineProperty")},function(e,t){e.exports=require("@babel/runtime/helpers/assertThisInitialized")},function(e,t){e.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/createClass")},function(e,t){e.exports=require("@babel/runtime/helpers/inherits")},function(e,t){e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("react-redux")},function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("@babel/runtime/helpers/extends")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("lodash/debounce")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("immer")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("react-avatar")},function(e,t){e.exports=require("redux-thunk")},function(e,t){e.exports=require("sprintf-js")},function(e,t){e.exports=require("redux-logger")},function(e,t){e.exports=require("remote-redux-devtools")},function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),o=n(5),i=n.n(o),s=n(2),c=n.n(s),l=n(6),u=n.n(l),d=n(7),p=n.n(d),m=n(3),f=n.n(m),h=n(1),v=n.n(h),g=n(0),E=n.n(g),y=n(10),S="Chat",_="Deleted Member",C="This message was deleted",N="Send a message",O="Share photo & video",b="Share a document",A="Search",M="Suggested",I="More Users",R="File",w="You",D="Send",T="Host",L="No conversation seleted",k="Enter your name to join the Chat",U="Please enter a valid name",F="Enter your name here",x="Ban User",P="Unban User",j="You are currently banned to send messages for this show.",G={admin_group_create:"%s created group %s",admin_group_join:"%s joined",admin_group_add_members:"%s added %s",admin_group_remove_members:"%s removed %s",admin_group_leave:"%s left",admin_group_make_admin:"%s are now an admin",admin_group_change_title:"%s changed the title to %s",admin_group_change_photo:"%s changed group photo",admin_call_video_missed:"%s missed a video call from %s",admin_call_voice_missed:"%s missed a voice call from %s",admin_custom_auction_winner:"Winner: %s",admin_custom_auction_backup:"Backup: %s"},V={admin_call_rejected:"Call Rejected",admin_call_completed:"Call Completed",admin_call_not_answered:"Call Not Answered",admin_call_missed:"Missed Call"},B="https://cdn.channelize.io/apps/web-widget/1.0.0/images/launcher-icon.svg",H=function(e,t){e({type:"CONNECT_SUCCESS",payload:t})},W=function(e,t){e({type:"CONNECT_FAIL",payload:t})};var q=function(e){return function(t){t({type:"SET_ACTIVE_CONVERSATION",payload:e})}},J=function(e){return function(t){t({type:"SET_ACTIVE_USERID",payload:e})}},Y=n(13),K=n.n(Y),z=E.a.createContext({client:null}),Q=z.Provider;function X(e){return Z(z,e)}var Z=function(e,t){var n=e,r=t,a=function(e){return E.a.createElement(n.Consumer,null,(function(t){return E.a.createElement(r,K()({},t,e))}))};return a.themePath=r.themePath,a.extraThemePaths=r.extraThemePaths,a.displayName=(a.displayName=r.displayName||r.name||"Component").replace("Base",""),a};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var te=function(e){u()(n,e);var t=ee(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"getContext",(function(){return{client:r.props.client}})),r.state={conversation:null,userId:null},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.client,n=e.userId,r=e.accessToken;t.connected?this.props.setConnected(!0):this.props.chConnect(t,n,r)}},{key:"componentDidUpdate",value:function(e){this.props.connected&&!e.connected&&this.props.connected&&this.props.registerEventHandlers(this.props.client)}},{key:"render",value:function(){this.props.connected;return E.a.createElement(Q,{value:this.getContext()},E.a.createElement("div",{className:"channelize-chat"},this.props.children))}}]),n}(g.PureComponent);te=Object(y.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.client)}),{chConnect:function(e,t,n){return function(r){return r({type:"CONNECTING",payload:{}}),function(e,t,n){return new Promise((function(r,a){if(e||a("Channelize.io client was not created."),t&&n)return e.connect(t,n,(function(e,t){return e?a("Channelize.io connection Failed."):r(t)}));e.connectAsAnonymous((function(e,t){e?a("Channelize.io connection Failed."):r(t)}))}))}(e,t,n).then((function(e){return H(r,e)})).catch((function(e){return W(r,e)}))}},registerEventHandlers:function(e){return function(t){e.chsocket.on("user.status_updated",(function(e){t({type:"USER_STATUS_UPDATED",payload:e})})),e.chsocket.on("user.updated",(function(e){t({type:"USER_UPDATED_EVENT",payload:e})})),e.chsocket.on("user.message_created",(function(e){t({type:"NEW_MESSAGE_RECEIVED_EVENT",payload:e})})),e.chsocket.on("message.deleted_for_everyone",(function(e){t({type:"DELETE_MESSAGE_FOR_EVERYONE_EVENT",payload:e})})),e.chsocket.on("user.message_deleted",(function(n){var r=n.conversation;e.Conversation.getConversation(r.id,null,(function(e,r){e||(n.conversation=r,t({type:"DELETE_MESSAGE_EVENT",payload:n}))}))})),e.chsocket.on("user.joined",(function(n){var r=n.conversation;e.Conversation.getConversation(r.id,null,(function(e,r){e||(n.conversation=r,t({type:"USER_JOINED_EVENT",payload:n}))}))})),e.chsocket.on("conversation.members_added",(function(e){t({type:"MEMBERS_ADDED_EVENT",payload:e})})),e.chsocket.on("conversation.members_removed",(function(e){t({type:"MEMBERS_REMOVED_EVENT",payload:e})})),e.chsocket.on("user.conversation_ban_updated",(function(e){t({type:"CONVERSATION_BAN_UPDATED_EVENT",payload:e})})),e.chsocket.on("conversation.updated",(function(e){t({type:"CONVERSATION_UPDATED_EVENT",payload:e})})),e.chsocket.on("conversation.mark_as_read",(function(e){t({type:"MARK_AS_READ_EVENT",payload:e})})),e.chsocket.on("conversation.typing",(function(e){t({type:"TYPING_EVENT",payload:e})})),e.chsocket.on("user.blocked",(function(e){t({type:"USER_BLOCKED_EVENT",payload:e})})),e.chsocket.on("user.unblocked",(function(e){t({type:"USER_UNBLOCKED_EVENT",payload:e})}))}},setConnected:function(){return function(e){e({type:"CONNECT_SUCCESS",payload:{}})}}})(te);var ne=n(20),re=n.n(ne),ae=n(9),oe=n.n(ae);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var le=function(e){u()(n,e);var t=ce(n);function n(e){return a()(this,n),t.call(this,e)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.initials,n=e.src,r=e.className,a=e.avatarProps,o=n&&n.trim(),i=se(se({},{maxInitials:2,size:30,round:!0}),a);return E.a.createElement(E.a.Fragment,null,o?E.a.createElement("div",{title:t,className:r,style:{backgroundImage:"url(".concat(n,")")}},this.props.children):E.a.createElement("div",{title:t,className:r},E.a.createElement(re.a,K()({name:t},i)),this.props.children))}}]),n}(g.PureComponent);function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}le.propTypes={src:oe.a.string,initials:oe.a.string,className:oe.a.string,avatarProps:oe.a.object},le.defaultProps={avatarProps:{}};var de=function(e){u()(n,e);var t=ue(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"toggleDropDownList",(function(){r.setState((function(e){return{showDropDownList:!e.showDropDownList}}))})),r.state={showDropDownList:!1},r}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.subtitle,r=e.imageSrc,a=e.imageInitials,o=e.showArrowBack,i=e.onBack,s=e.showChevron,c=e.renderDropDownList,l=e.renderRight,u=e.callButtons,d=this.state.showDropDownList;return E.a.createElement("div",{id:"ch_header",className:"ch-header"},o&&E.a.createElement("i",{className:"material-icons arrow-back",onClick:i},"arrow_back"),(r||a)&&E.a.createElement(le,{src:r,initials:a,className:"ch-header-image"}),E.a.createElement("div",{className:"ch-header_details"},E.a.createElement("div",{className:"ch-header_content"},t&&E.a.createElement("div",{className:"ch-header-title"},E.a.createElement("div",null,t),s&&E.a.createElement("i",{className:"material-icons ch-chevron-icon",onClick:this.toggleDropDownList},"keyboard_arrow_down")),n&&E.a.createElement("div",{className:"ch-header-subtitle"},n),d&&c&&c()),u,E.a.createElement("div",{className:"ch-header_right-icons"},l&&this.props.renderRight())))}}]),n}(g.PureComponent);function pe(e){var t=e.onClick;return E.a.createElement("div",{id:"ch_launcher",className:"ch-launcher",onClick:t},E.a.createElement("img",{id:"ch_launcher_image",className:"ch-launcher-image",src:B,alt:""}))}function me(e){return E.a.createElement("div",{id:"ch_conv_loader_container"},E.a.createElement("div",{id:"ch_conv_loader",className:"ch-loader"}))}var fe=n(18),he=n(17),ve=n.n(he),ge=n(22).sprintf;function Ee(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length>1?arguments[1]:void 0;return Object(fe.produce)(n,(function(e){var n=t[r.type];return n?n(e,r):void 0}))}}function ye(e){return e.reduce((function(e,t){var n=e.map((function(e){return e.id}));return n.indexOf(t.id)<0?e.push(t):e.splice(n.indexOf(t.id),1,t),e}),[])}Object(fe.setAutoFreeze)(!1);var Se=function(e,t){if(e)return e.isGroup||(e.user?(e.title=e.user.displayName,e.user.profileImageUrl&&(e.profileImageUrl=e.user.profileImageUrl)):e.title="Deleted User"),e.otherMemberIds=[],e.members&&e.members.map((function(n){n.userId!=t.id&&e.otherMemberIds.push(n.userId)})),e},_e=function(e,t,n){var r,a=e.getCurrentUser();return n.forEach((function(e){a.id==e.ownerId&&(r=e)})),n.map((function(e,o){if(e.readByAll=null,e.showReadStatus=!1,r&&r.id==e.id&&(e.showReadStatus=!0,e.readByAll=!e.pending&&t.readByAllMembers(e)),"createdAt"in e||(e.createdAt=Date.now()),e.time=Oe(e.createdAt),e.owner||(e.owner={id:a.id,displayName:a.displayName,profileImageUrl:a.profileImageUrl}),"displayName"in e.owner&&(e.owner.displayName=Re(e.owner.displayName)),e.isUser=!1,a.id==e.ownerId&&(e.isUser=!0),e.isDeleted&&(e.body=C),o<n.length){var i=n[o+1];e.showOwnerAvatar=!1;var s=o==n.length-1&&a.id==e.owner.id;e.showOwnerAvatar=!(Ie(e,i,a)||s||e.isUser);var c=n[o-1];e.showDateSeparator=!Ae(e,c)}return"admin"==e.type&&(e.system=!0,e=we(a,e)),e}))},Ce=function(e,t){var n,r=e.getCurrentUser(),a=t.lastMessage;if(!Object.keys(a).length)return n="";if("admin"==a.type)return n="Admin message";var o,i=a.attachments;if(i&&i.length){var s=i[0];if(a.owner.id==r.id)n="You sent a ".concat(s.type);else{var c=Re(a.owner.displayName);n="".concat(c," sent a ").concat(s.type)}return n}if(a.owner)if(a.owner.id==r.id)o="You: ";else if(t.isGroup){var l=Re(a.owner.displayName);o="".concat(l,": ")}return a.isDeleted&&(a.body="This message was deleted."),n=o?"".concat(o).concat(a.body):"".concat(a.body)};function Ne(e){var t=new Date,n=t.getDate(),r=t.getMonth()+1,a=t.getFullYear(),o=new Date(e),i=o.getDate(),s=o.getMonth()+1,c=o.getFullYear(),l=c==a&&s==r&&n-i<=7;if(c==a&&s==r&&i==n)return Oe(o);if(l){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][o.getDay()]}return s+"/"+i+"/"+c}function Oe(e){var t=new Date(e),n=t.getHours(),r=n>=12?"PM":"AM";return(n=n%12||12)+":"+("0"+t.getMinutes()).substr(-2)+" "+r}function be(e){var t=new Date,n=t.getDate(),r=t.getMonth()+1,a=t.getFullYear(),o=new Date(e),i=o.getDate(),s=o.getMonth()+1,c=o.getFullYear();return c==a&&s==r&&n==i?"Today":c==a&&s==r&&n-i==1?"Yesterday":s+"/"+i+"/"+c}function Ae(e,t){if(!(e&&e.createdAt&&t&&t.createdAt))return!1;var n=new Date(e.createdAt),r=new Date(t.createdAt);return n.getDate()==r.getDate()}var Me=function(e){if(!e.length)return null;if(1==(e=e.map((function(e){return Re(e.displayName.trim().split(" ")[0])}))).length)return"".concat(e[0]," is typing...");if(2==e.length){var t=e[0];e[1];return"".concat(t," and {secondUser} are typing...")}if(e.length>2){var n=e.slice(0,-1).join(", ");e.slice(-1);return"".concat(n," and {lastuser} are typing...")}};function Ie(e,t,n){return!(!(t&&t.owner&&e.owner)||n.id!==e.owner.id&&t.owner.id!==e.owner.id)}var Re=function(e){if(e){for(var t=0,n=(e=e.split(" ")).length;t<n;t++)e[t]?e[t]=e[t][0].toUpperCase()+e[t].substr(1):e[t]=e[t];return e.join(" ")}},we=function(e,t){if("admin"!=t.type)return t;var n=t.attachments;if(!n.length)return t;var r,a,o=n[0],i=o.metaData;if("voice"==i.type||"video"==i.type){var s=i.duration?" "+function(e){e=Number(e);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(t>0?t+"h ":"")+(n>0?n+"m ":"")+(r>0?r+"s ":"")}(i.duration):"";return t.text=V[o.adminMessageType]+s,t}"user"==i.subType&&(r=e.id==i.subId?w:i.subUser?Re(i.subUser.displayName):_);i.objType;var c=i.objValues;if("user"==i.objType)a=i.objUsers?e.id==i.objUsers.id?w:Re(i.objUsers.displayName):_;else if("users"==i.objType&&Array.isArray(c)){var l=[];c.forEach((function(e){var t,n=i.objUsers.find((function(t){return t&&t.id==e}));t=n?Re(n.displayName):_,l.push(t)})),a=l.join(", ")}else"group"==i.objType&&(a="string"==typeof c?Re(c):c);var u=G[o.adminMessageType];return u&&(t.text=ge(u,r,a)),t};var De=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var a=n[r];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""},Te=function(e,t,n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var a="expires="+r.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"};function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Fe=function(e){u()(n,e);var t=Ue(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"selectConversation",(function(){var e=r.props,t=e.conversation,n=e.onSelect;r.props.setActiveConversation(t),n&&"function"==typeof n&&n(t)})),r}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.client,n=e.activeConversation,r=e.conversation,a=ke({},r.lastMessage),o=Ce(t,r);a.createdAt?a.time=Ne(a.updatedAt):a.time=Ne(Date());var i={};return n&&n.id==r.id&&(i={backgroundColor:"#fafafa"}),E.a.createElement("li",{style:i,id:r.id,onClick:this.selectConversation},E.a.createElement(le,{src:r.profileImageUrl,initials:r.title,className:"ch-conversation-image"},r&&r.user&&r.user.isOnline&&E.a.createElement("span",{className:"ch-online-icon ch-show-element"})),E.a.createElement("div",{className:"ch-conversation-content"},E.a.createElement("div",{className:"ch-conversation-content__upper"},E.a.createElement("div",{id:"ch_title"},r.title),E.a.createElement("div",{id:"ch_created_at",className:"ch-created-at"},a.time)),E.a.createElement("div",{className:"ch-conversation-content__lower"},E.a.createElement("div",{id:"ch_last_msg_box",className:"ch-last-msg-box"},E.a.createElement("div",{className:"ch-last-message"},o)))))}}]),n}(g.PureComponent);Fe=X(Fe);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}Fe=Object(y.connect)((function(e){return ke({},e.conversation)}),{setActiveConversation:q})(Fe);var Ge=function(e){u()(n,e);var t=je(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"_init",(function(){var e=r.props,t=e.client;if(!e.conversationlist.length){var n=t.Conversation.createConversationListQuery();n.limit=r.limit,n.skip=r.skip,n.include="members",r.props.getConversationList(n)}})),v()(c()(r),"onCloseIconClick",(function(){var e=r.props.onCloseIconClick;e&&"function"==typeof e&&e()})),v()(c()(r),"onSearchIconClick",(function(){var e=r.props.onSearchIconClick;e&&"function"==typeof e&&e()})),r.limit=25,r.skip=0,r.onScroll=r.onScroll.bind(c()(r)),r.chRecentListingRef=E.a.createRef(),r}return i()(n,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=(t.client,t.connected),r=t.activeConversation,a=t.conversationlist;n&&(!e.connected&&this.props.connected&&this._init(),!r&&a.length&&this.props.setActiveConversation(a[0]))}},{key:"onScroll",value:function(){var e=this.props,t=e.conversationlist,n=e.client,r=e.loadingMoreConversations,a=e.allConversationsLoaded,o=this.chRecentListingRef.current;if(!(r||a||t.length<this.limit)&&o.scrollTop+o.clientHeight==o.scrollHeight){this.skip=t.length;var i=n.Conversation.createConversationListQuery();i.limit=this.limit,i.skip=this.skip,this.props.loadMoreConversations(i)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.client,r=t.conversationlist,a=t.connecting,o=t.connected,i=t.conversationLoading,s=t.conversationError,c=t.loadingMoreConversations,l=t.showSearchIcon,u=(t.onSearchIconClick,t.showCloseIcon),d=t.activeConversation,p=t.onSelect,m=n.getCurrentUser();return r=r.map((function(e){return Se(e,m)})),E.a.createElement("div",{id:"ch_recent_window",className:"ch-recent-window"},E.a.createElement(de,{imageSrc:m&&m.profileImageUrl,imageInitials:m&&m.displayName,title:S,renderRight:function(){return E.a.createElement("div",null,l&&E.a.createElement("i",{title:"Search",className:"material-icons",onClick:e.onSearchIconClick},"search"),u&&E.a.createElement("i",{title:"Close",className:"material-icons",onClick:e.onCloseIconClick},"close"))}}),E.a.createElement("div",{id:"ch_recent_listing",className:"ch-recent-listing",ref:this.chRecentListingRef,onScroll:this.onScroll},(a||i)&&E.a.createElement("div",{className:"center"},E.a.createElement(me,null)),s&&E.a.createElement("div",{className:"center error"},s),o&&!r.length&&!i&&E.a.createElement("div",{className:"center no-record-found"},"No record Found"),E.a.createElement("ul",{id:"ch_recent_ul",className:"ch-recent-ul"},r.map((function(e){return E.a.createElement(Fe,{key:e.id,activeConversation:d,conversation:e,onSelect:p})}))),c&&E.a.createElement("div",null," Loading... ")))}}]),n}(g.PureComponent);Ge=X(Ge);Ge=Object(y.connect)((function(e){var t=e.conversation,n=e.client,r=e.message;return Pe(Pe(Pe({},t),n),{},{activeConversation:r.conversation})}),{getConversationList:function(e){return function(t){return t({type:"LOADING_CONVERSATION_LIST",payload:{}}),e.list((function(e,n){e&&t({type:"CONVERSATION_LIST_FAIL",payload:e}),t({type:"CONVERSATION_LIST_SUCCESS",payload:n})}))}},loadMoreConversations:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_CONVERSATIONS",payload:{}}),e.list((function(e,n){e&&t({type:"LOAD_MORE_CONVERSATIONS_FAIL",payload:e}),t({type:"LOAD_MORE_CONVERSATIONS_SUCCESS",payload:n})}))}},setActiveConversation:q})(Ge);var Ve=n(11),Be=n.n(Ve),He=n(14),We=n.n(He);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Je=function(e){u()(n,e);var t=qe(n);function n(){return a()(this,n),t.apply(this,arguments)}return i()(n,[{key:"downloadFile",value:function(e,t){t=t||R;var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e=this,t=this.props.file,n=t.fileUrl?t.fileUrl:t.thumbnailUrl;return E.a.createElement("div",{className:"ch-light-box-container"},E.a.createElement("div",null,E.a.createElement("i",{title:"Close",className:"material-icons ch-close-light-box-icon",onClick:this.props.onCloseClick},"close"),E.a.createElement("i",{title:"Download",className:"material-icons ch-close-light-box-icon",onClick:function(){return e.downloadFile(n,t.name)}},"arrow_downward")),"image"==t.type&&E.a.createElement("img",{className:"ch-light-box-file",src:n}),"video"==t.type&&E.a.createElement("video",{controls:!0,id:"videoPlayer",className:"ch-light-box-file",preload:"auto",loop:"loop",autoPlay:"autoplay"},E.a.createElement("source",{src:n})))}}]),n}(g.PureComponent);function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Ke=function(e){u()(r,e);var t,n=Ye(r);function r(e){var t;return a()(this,r),(t=n.call(this,e)).state={displayName:"",errors:{},joining:!1},t.handleChange=t.handleChange.bind(c()(t)),t.handleSubmit=t.handleSubmit.bind(c()(t)),t}return i()(r,[{key:"handleChange",value:function(e){var t;this.setState((t={},v()(t,e.target.name,e.target.value),v()(t,"errors",{}),t))}},{key:"validateForm",value:function(){var e=this.state.displayName.trim(),t={};return(!e||e.length>30)&&(t.displayName=U),this.setState({errors:t}),!Object.keys(t).length}},{key:"handleSubmit",value:(t=We()(Be.a.mark((function e(t){var n,r,a,o,i;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.client,a=n.onJoinedAsGuest,o=n.onCloseClick,i=this.state.displayName.trim(),t.preventDefault(),this.validateForm()){e.next=5;break}return e.abrupt("return",!1);case 5:return this.setState({joining:!0}),e.next=8,r.switchToGuest(i);case 8:if(Te("ch_guest_display_name",i,1e3),!a){e.next=12;break}return e.next=12,a(i);case 12:this.setState({joining:!1}),o();case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.onCloseClick,t=this.state,n=t.joining,r=t.errors;return E.a.createElement("div",{className:"ch-light-box-container ch-guest-light-box-container"},E.a.createElement("div",{className:"ch-guest-light-box"},E.a.createElement("div",{className:"ch-guest-light-box-close-container"},E.a.createElement("i",{title:"Close",className:"material-icons ch-guest-light-box-close",onClick:e},"close")),E.a.createElement("form",{onSubmit:this.handleSubmit},E.a.createElement("div",{className:"form-element-wrapper"},E.a.createElement("div",{className:"form-heading"},k)),E.a.createElement("div",{className:"form-element-wrapper"},E.a.createElement("input",{id:"displayName",className:"form-element",name:"displayName",type:"text",placeholder:F,value:this.state.displayName,onChange:this.handleChange}),r.displayName&&E.a.createElement("div",{className:"form-error"},r.displayName)),E.a.createElement("div",{className:"form-element-wrapper"},E.a.createElement("input",{type:"submit",value:"Join",disabled:n})))))}}]),r}(g.PureComponent);function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}(Ke=X(Ke)).propTypes={onJoinedAsGuest:oe.a.func,onCloseClick:oe.a.func};var Qe={BLOCK:"block",FLEX:"flex",INLINE:"inline",INLINE_BLOCK:"inline-block",CONTENTS:"contents"},Xe={children:oe.a.node.isRequired,onOutsideClick:oe.a.func.isRequired,disabled:oe.a.bool,useCapture:oe.a.bool,display:oe.a.oneOf(Object.values(Qe))},Ze={disabled:!1,useCapture:!0,display:Qe.BLOCK},$e=function(e){u()(n,e);var t=ze(n);function n(){var e;a()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).onMouseDown=e.onMouseDown.bind(c()(e)),e.onMouseUp=e.onMouseUp.bind(c()(e)),e.setChildNodeRef=e.setChildNodeRef.bind(c()(e)),e}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.disabled,n=e.useCapture;t||this.addMouseDownEventListener(n)}},{key:"componentDidUpdate",value:function(e){var t=e.disabled,n=this.props,r=n.disabled,a=n.useCapture;t!==r&&(r?this.removeEventListeners():this.addMouseDownEventListener(a))}},{key:"componentWillUnmount",value:function(){this.removeEventListeners()}},{key:"onMouseDown",value:function(e){var t=this.props.useCapture;this.childNode&&(this.childNode&&this.childNode.contains(e.target)||document.addEventListener("mouseup",this.onMouseUp,{capture:t}))}},{key:"onMouseUp",value:function(e){var t=this.props.onOutsideClick;this.childNode&&(this.childNode&&this.childNode.contains(e.target)||t(e))}},{key:"setChildNodeRef",value:function(e){this.childNode=e}},{key:"addMouseDownEventListener",value:function(e){document.addEventListener("mousedown",this.onMouseDown,{capture:e})}},{key:"removeEventListeners",value:function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.display;return E.a.createElement("div",{className:"outside-event",ref:this.setChildNodeRef,style:n!==Qe.BLOCK&&Object.values(Qe).includes(n)?{display:n}:void 0},t)}}]),n}(E.a.Component);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}$e.propTypes=Xe,$e.defaultProps=Ze;var tt=function(e){u()(n,e);var t=et(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"toggleMoreOptions",(function(){r.setState((function(e){return{showMoreOptions:!e.showMoreOptions}}))})),v()(c()(r),"hideMoreOptions",(function(){r.state.showMoreOptions&&r.setState((function(e){return{showMoreOptions:!1}}))})),r.state={showMoreOptions:!1},r}return i()(n,[{key:"downloadFile",value:function(e,t){var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.client,a=n.message,o=n.renderMoreOptions,i=this.state.showMoreOptions,s=(r.getCurrentUser(),a.isUser?"right":"left"),c="admin"===a.type;return a.attachments&&a.attachments.length&&(e=a.attachments.map((function(e){switch(e.type){case"image":return E.a.createElement("img",{key:a.id,className:"ch-image-message",src:e.thumbnailUrl?e.thumbnailUrl:e.fileUr,onClick:t.props.onClickEvent});case"video":return E.a.createElement("div",{key:a.id,className:"ch-video-container"},E.a.createElement("img",{className:"ch-image-message",src:e.thumbnailUrl,onClick:t.props.onClickEvent}),E.a.createElement("i",{className:"material-icons ch-video-play-icon",onClick:t.props.onClickEvent},"play_circle_outline"));case"application":var n=a.attachments[0].extension?a.attachments[0].extension:a.attachments[0].name.split(".").pop();return E.a.createElement("div",{key:a.id,className:"ch-text-message"},E.a.createElement("div",{className:"ch-message"},E.a.createElement("div",{className:"ch-message-body"},E.a.createElement("div",{className:"ch-docs-data"},E.a.createElement("i",{className:"material-icons ch-attachment-icon"},"description"),E.a.createElement("span",{className:"ch-docs-name"},e.name),e.fileUrl&&E.a.createElement("i",{className:"material-icons ch-docs-download-icon",onClick:function(){return t.downloadFile(e.fileUrl,e.name)}},"arrow_downward")),E.a.createElement("div",{className:"ch-docs-details"},E.a.createElement("hr",null),E.a.createElement("span",null,n)))));default:return null}}))),E.a.createElement(E.a.Fragment,null,a.showDateSeparator&&E.a.createElement("div",{key:"".concat(a.id,"-date"),className:"ch-msg-padding"},E.a.createElement("div",{className:"ch-message-date-separator"},E.a.createElement("div",{className:"message-date-separator_left"}),E.a.createElement("div",{className:"message-date-separator_text"},be(a.createdAt)),E.a.createElement("div",{className:"message-date-separator_right"}))),c?E.a.createElement("div",{className:"ch-admin-msg-container"},E.a.createElement("span",{className:"ch-admin-msg"},a.text)):E.a.createElement("div",{key:a.id,className:"ch-msg-padding ".concat(s)},E.a.createElement("div",{className:"ch-msg-container ch-msg-container-simple"},a.showOwnerAvatar&&E.a.createElement(le,{src:a.owner.profileImageUrl,initials:a.owner.displayName,className:"ch-message-owner-avatar"}),E.a.createElement("div",{className:"ch-msg-content ".concat("left"!=s||a.showOwnerAvatar?"":"padding-left")},a.body&&E.a.createElement("div",{className:"ch-text-message ".concat(a.isDeleted?"deleted":"")},a.body),e,E.a.createElement("div",{className:"message-info"},E.a.createElement("span",{id:"ch_msg_time",className:"ch-msg-time"},a.time),a.showReadStatus&&a.readByAll&&E.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status ch-msg-read-status"},"done_all"),a.showReadStatus&&!a.pending&&!a.readByAll&&E.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status"},"done"),a.showReadStatus&&a.pending&&E.a.createElement("i",{id:"ch_msg_status",className:"material-icons ch-msg-status"},"schedule"))),E.a.createElement("div",{className:"ch-msg-more-icon"},E.a.createElement("i",{className:"material-icons",onClick:function(){return t.toggleMoreOptions()}},"more_vert")),E.a.createElement($e,{onOutsideClick:function(){return t.hideMoreOptions()}},E.a.createElement("div",{onClick:function(){return t.toggleMoreOptions()}},i&&o&&o())))))}}]),n}(g.Component);function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}tt=X(tt);var rt=function(e){u()(n,e);var t=nt(n);function n(e){return a()(this,n),t.call(this,e)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.action;return E.a.createElement("li",null,E.a.createElement("div",{className:"title"},E.a.createElement("span",null,t)),E.a.createElement("div",{className:"action"},n&&n()))}}]),n}(g.Component);rt=X(rt);var at=n(16),ot=n(19),it=n.n(ot),st=n(15),ct=n.n(st);function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var pt=function(e){u()(r,e);var t,n=dt(r);function r(e){var t;return a()(this,r),t=n.call(this,e),v()(c()(t),"_markAsRead",(function(e){e&&e.config.typing_events&&e.markAsRead()})),v()(c()(t),"_scrollToTarget",(function(e){if(t.chMessageBoxRef){var n=t.chMessageBoxRef.current;"[object Number]"!==Object.prototype.toString.call(e)?n.scrollTop=n.scrollHeight:n.scrollTop=e}})),v()(c()(t),"_init",(function(){var e=t.props,n=e.client,r=e.conversation,a=e.userId,o=e.ownProps;if(t.handleTabChange("chat"),r||a){if(!r){t.setState({dummyConversation:null});var i=n.Conversation.createConversationListQuery();a&&(i.membersExactly=a,i.isGroup=!1),i.list((function(e,r){r.length?t.props.setActiveConversation(r[0]):n.User.get(a,(function(e,n){t.setState({dummyConversation:{isGroup:!1,user:n}})}))}))}if(r){t.props.registerConversationEventHandlers(r);var s=r.createMessageListQuery();if(s.limit=t.limit,t.skip=0,s.skip=t.skip,t.props.getMessageList(s),r.isGroup&&r.isAdmin){var c=r.createBanListQuery();c.limit=100,t.props.getConversationBanList(c)}r.unreadMessageCount>0&&r.markAsRead()}}else if(Object.keys(o).length){if(o.conversation){var l=o.conversation;return"open"!=l.type||l.__isWatching?void t.props.setActiveConversation(l):void t.props.startWatchingAndSetActiveConversation(l)}if(o.userId)return void t.props.setActiveUserId(o.userId)}})),v()(c()(t),"_onTextMessageChanged",(function(e){e&&t._startTyping(),t._stopTyping()})),v()(c()(t),"_startTyping",(function(){var e=t.props.conversation;e&&"private"==e.type&&e.startTyping()})),v()(c()(t),"_stopTyping",(function(){var e=t.props.conversation;e&&"private"==e.type&&e.stopTyping()})),v()(c()(t),"onCloseIconClick",(function(){t.props.setActiveConversation(null);var e=t.props.onCloseIconClick;e&&"function"==typeof e&&e()})),t.limit=25,t.skip=0,t.showMediaLightBox=!1,t.handleChange=t.handleChange.bind(c()(t)),t.handleTabChange=t.handleTabChange.bind(c()(t)),t.handleKeyPress=t.handleKeyPress.bind(c()(t)),t.sendMessage=t.sendMessage.bind(c()(t)),t.onScroll=t.onScroll.bind(c()(t)),t._markAsRead=it()(t._markAsRead,500),t.sendMedia=t.sendMedia.bind(c()(t)),t._startTyping=it()(t._startTyping,3e3),t._stopTyping=ct()(t._stopTyping,3e3),t.toggleGuestJoinForm=t.toggleGuestJoinForm.bind(c()(t)),t.onJoinedAsGuest=t.onJoinedAsGuest.bind(c()(t)),t.chMessageBoxRef=E.a.createRef(),t.state={text:"",dummyConversation:null,userId:null,guestJoinFormOpened:!1,enabledTabName:"chat"},t}return i()(r,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"getSnapshotBeforeUpdate",value:function(e){if(e.messagelist.length<this.props.messagelist.length){if(!this.chMessageBoxRef||!this.chMessageBoxRef.current)return null;var t=this.chMessageBoxRef.current;return{scrollHeight:t.scrollHeight,offsetTop:t.scrollTop,offsetBottom:t.scrollHeight-t.scrollTop}}return null}},{key:"componentDidUpdate",value:function(e,t,n){var r=this,a=this.props,o=a.client,i=a.conversation,s=a.newMessage,c=a.userId;a.loadingMoreMessages;if(!e.connected&&this.props.connected&&this._init(),e.userId!=c&&c&&this._init(),!i&&e.sendingMessage&&!this.props.sendingMessage){this._scrollToTarget();var l=o.Conversation.createConversationListQuery();c&&(l.membersExactly=c,l.isGroup=!1),l.list((function(e,t){t.length?r.props.setActiveConversation(t[0]):o.User.get(c,(function(e,t){r.setState({dummyConversation:{isGroup:!1,user:t}})}))}))}if(i){if((!e.conversation&&i||e.conversation.id!=i.id)&&this._init(),e.messageLoading&&!this.props.messageLoading&&this._scrollToTarget(),!e.newMessage&&s||s&&e.newMessage.id!=s.id)this._scrollToTarget(),o.getCurrentUser().id!=s.ownerId&&this._markAsRead(i);if(e.messagelist.length<this.props.messagelist.length&&n){var u=this.chMessageBoxRef.current.scrollHeight-n.offsetBottom;this._scrollToTarget(u)}}}},{key:"componentWillUnmount",value:function(){var e=this.props.conversation;e&&"open"==e.type&&e.__isWatching?this.props.stopWatchingAndSetNullConversation(e):this.props.setActiveConversation(null)}},{key:"handleChange",value:function(e){this.setState({text:e.target.value})}},{key:"handleTabChange",value:function(e){this.setState({enabledTabName:e})}},{key:"handleKeyPress",value:function(e){if("Enter"===e.key)return e.preventDefault(),void this.sendMessage();this._onTextMessageChanged(e.target.value)}},{key:"toggleGuestJoinForm",value:function(){this.setState({guestJoinFormOpened:!this.state.guestJoinFormOpened})}},{key:"onJoinedAsGuest",value:(t=We()(Be.a.mark((function e(t){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.onJoinedAsGuest(t);case 2:return e.next=4,this.sendMessage();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"sendFile",value:function(e){var t=this,n=this.props,r=n.client,a=n.conversation,o=r.getCurrentUser(),i=e.type.split("/").shift();if(e.type.match("application")){var s={id:Object(at.v4)(),pending:!0,ownerId:o.id,attachments:[{type:i,name:e.name}]};this.props.sendFileToConversation(r,a,e,s,i)}else this.getFileThumbnailUrl(e,(function(n){var s={id:Object(at.v4)(),pending:!0,ownerId:o.id,attachments:[{type:i,thumbnailUrl:n}]};e.type.match("video")&&(s.attachments[0].fileUrl=URL.createObjectURL(e)),t.props.sendFileToConversation(r,a,e,s,i)}))}},{key:"deleteMessagesForEveryone",value:function(e){if(e){var t=this.props.client;this.props.deleteMessagesForEveryone(t,[e])}}},{key:"deleteMessagesForMe",value:function(e){if(e){var t=this.props.client;this.props.deleteMessagesForMe(t,[e])}}},{key:"banConversationUsers",value:function(e,t){if(e){var n=this.props,r=(n.client,n.conversation);this.props.banConversationUsers(r,[e],t)}}},{key:"unbanConversationUsers",value:function(e){if(e){var t=this.props,n=(t.client,t.conversation);this.props.unbanConversationUsers(n,[e])}}},{key:"sendMessage",value:function(){var e=this.props,t=e.conversation,n=e.client,r=e.userId;if(e.allowGuestUsers&&n.isAnonymousUser())return this.toggleGuestJoinForm();var a=n.getCurrentUser(),o=this.state.text;if(o){var i={id:Object(at.v4)(),body:o,ownerId:a.id,pending:!0};this.setState({text:""}),t?this.props.sendMessageToConversation(t,i):(i.userId=r,this.props.sendMessageToUserId(n,i))}}},{key:"getFileThumbnailUrl",value:function(e,t){var n=new FileReader;e.type.match("image")?(n.onload=function(){document.createElement("img");t(n.result)},n.readAsDataURL(e)):e.type.match("video")&&(n.onload=function(){var r=new Blob([n.result],{type:e.type}),a=URL.createObjectURL(r),o=document.createElement("video"),i=function e(){s()&&(o.removeEventListener("timeupdate",e),o.pause())};o.addEventListener("loadeddata",(function(){s()&&o.removeEventListener("timeupdate",i)}));var s=function(){var e=document.createElement("canvas");e.width=o.videoWidth,e.height=o.videoHeight,e.getContext("2d").drawImage(o,0,0,e.width,e.height);var n=e.toDataURL(),r=n.length>1e5;r&&(document.createElement("img").src=n,t(n),URL.revokeObjectURL(a));return r};o.addEventListener("timeupdate",i),o.preload="metadata",o.src=a,o.muted=!0,o.playsInline=!0,o.play()},n.readAsArrayBuffer(e))}},{key:"onScroll",value:function(){var e=this.props,t=e.messagelist,n=e.conversation,r=e.loadingMoreMessages,a=e.allMessagesLoaded;if(!n)return null;var o=this.chMessageBoxRef.current;if(!(r||a||t.length<this.limit)&&o.scrollTop<o.clientHeight){this.skip=t.length;var i=n.createMessageListQuery();i.limit=this.limit,i.skip=this.skip,this.props.loadMoreMessagesAction(i)}}},{key:"blockUser",value:function(){}},{key:"unblockUser",value:function(){}},{key:"sendMedia",value:function(e){this.sendFile(e.target.files[0]),e.target.value=null}},{key:"viewMediaToggle",value:function(e){var t=e?e.attachments[0]:null;this.setState({openMediaFile:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.client,r=t.connecting,a=t.connected,o=t.messageError,i=t.messageLoading,s=t.loadingMoreMessages,c=t.messagelist,l=t.conversation,u=t.showCloseIcon,d=t.showChevron,p=t.disableComposer,m=t.disableComposerMessage,f=t.Message,h=t.showHeader,v=void 0===h||h,g=t.renderHeader,y=t.showComposerActions,S=void 0===y||y,_=t.typing,C=t.noConversationFoundMessage,A=(t.allowGuestUsers,t.banList),M=this.state,I=M.text,R=M.dummyConversation,w=M.enabledTabName;l||(l=R,c=[]),c=_e(n,l,c);var T,L,k,U,F=!1;p&&"function"==typeof p&&(F=p(l));var G=[],V=n.getCurrentUser();l&&(L=(l=Se(l,V)).title,k=l.profileImageUrl,!l.isGroup&&l.user&&(U=l.user.isOnline?"Online":"Last Seen "+ve()(l.user.lastSeen).fromNow()),l.isGroup&&(U=l.memberCount+" Members"),T=l.isActive?E.a.createElement("div",{id:"ch_conv_block",onClick:function(){return e.blockUser()}},"Block User"):E.a.createElement("div",{id:"ch_conv_unblock",onClick:function(){return e.unblockUser()}},"Unblock User"),l.ban&&Object.keys(l.ban).length&&(F=!0,m=j),l.members&&l.members.length&&(G=l.members.filter((function(e){return!0===e.isAdmin})).map((function(e){return e.userId}))));var B=Me(_),H=!r&&!i&&l&&l.isAdmin&&l.type&&["open","public"].includes(l.type);return E.a.createElement("div",{id:"ch_conv_window",className:"ch-conv-window"},l&&v&&g&&g(l),l&&v&&!g&&E.a.createElement(de,{imageSrc:k,imageInitials:L,title:L,subtitle:U,showChevron:!(!d||!T),renderDropDownList:function(){if(T)return E.a.createElement("div",{className:"ch-drop-down-list"},T)},renderRight:function(){return E.a.createElement(E.a.Fragment,null,u&&E.a.createElement("i",{title:"Close",className:"material-icons",onClick:e.onCloseIconClick},"close"))}}),H&&E.a.createElement("div",{className:"conversation-window-tabs"},E.a.createElement("button",{onClick:function(){return e.handleTabChange("chat")},className:"chat "+("chat"==w?"active":"")},"Chat"),E.a.createElement("button",{onClick:function(){return e.handleTabChange("manage")},className:"manage "+("manage"==w?"active":"")},"Manage")),E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{style:{display:"chat"==w?"block":"none"},id:"ch_messages_box",ref:this.chMessageBoxRef,className:"ch-messages-box",onScroll:this.onScroll},E.a.createElement("div",{className:"ch-conversation-padding"}," "),(r||i)&&E.a.createElement("div",{className:"center"},E.a.createElement(me,null)),o&&E.a.createElement("div",{className:"center error"},o),E.a.createElement("div",{className:"ch-msg-list"},a&&!l&&!i&&C&&E.a.createElement("div",{className:"center no-record-found"},C),s&&E.a.createElement(me,null),l&&!c.length&&!i&&E.a.createElement("div",{className:"center no-record-found"},"Be the first one to post a message!"),c.map((function(t){return E.a.createElement(f,{key:t.id,message:t,isSentByAdmin:G.includes(t.ownerId),onClickEvent:function(){return e.viewMediaToggle(t)},renderMoreOptions:function(){return E.a.createElement("div",{className:"ch-more-options-container"},t.ownerId==V.id&&!t.isDeleted&&E.a.createElement("p",{onClick:function(){return e.deleteMessagesForEveryone(t.id)}},"Delete for everyone"),!["open","public"].includes(l.type)&&E.a.createElement("p",{onClick:function(){return e.deleteMessagesForMe(t.id)}},"Delete for me"),t.ownerId!=V.id&&l.isGroup&&l.isAdmin&&!A.find((function(e){return e.userId==t.ownerId}))&&E.a.createElement("p",{onClick:function(){return e.banConversationUsers(t.ownerId,t.owner.displayName)}},x),t.ownerId!=V.id&&l.isGroup&&l.isAdmin&&A.find((function(e){return e.userId==t.ownerId}))&&E.a.createElement("p",{onClick:function(){return e.unbanConversationUsers(t.ownerId)}},P))}})})),E.a.createElement("div",{className:"ch-typing-strings"},B))),l&&E.a.createElement("div",{style:{display:"chat"==w?"block":"none"}},F?E.a.createElement("div",{className:"ch-composer-disabled-box"},E.a.createElement("div",null,m)):E.a.createElement("div",{id:"ch_send_box",className:"ch-send-box"},S&&E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:"ch-media-icon-box"},E.a.createElement("i",{title:O,className:"material-icons ch-attachment-icon"},"insert_photo"),E.a.createElement("input",{id:"ch_gallary_input",title:O,className:"ch-gallary-input",type:"file",accept:"image/*, video/*",onChange:this.sendMedia})),E.a.createElement("div",{className:"ch-media-icon-box"},E.a.createElement("i",{title:b,className:"material-icons ch-attachment-icon"},"description"),E.a.createElement("input",{id:"ch_document_input",title:b,className:"ch-document-input",type:"file",accept:"application/*,.doc,.docx,.xls,.ppt",onChange:this.sendMedia}))),E.a.createElement("textarea",{id:"ch_input_box",className:"ch-input-box",type:"text",placeholder:N,value:I,onKeyPress:function(t){e.handleKeyPress(t)},onChange:function(t){e.handleChange(t)}}),E.a.createElement("button",{id:"ch_send_button",className:"ch-send-button",title:D,onClick:this.sendMessage},E.a.createElement("i",{className:"ch-send-icon material-icons"},"send")))),this.state.openMediaFile&&E.a.createElement(Je,{file:this.state.openMediaFile,onCloseClick:function(){return e.viewMediaToggle(null)}}),this.state.guestJoinFormOpened&&E.a.createElement(Ke,{onCloseClick:this.toggleGuestJoinForm,onJoinedAsGuest:this.onJoinedAsGuest})),E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:"conversation-window-manage",style:{display:"manage"==w?"block":"none"}},E.a.createElement("ul",null,A.map((function(t){return E.a.createElement(rt,{key:t.userId,title:t.user.displayName,action:function(){return E.a.createElement(E.a.Fragment,null,E.a.createElement("span",{onClick:function(){return e.unbanConversationUsers(t.userId)}},P))}})}))))))}}]),r}(g.PureComponent);(pt=X(pt)).propTypes={Message:oe.a.elementType},pt.defaultProps={Message:tt,showHeader:!0,showComposerActions:!0,noConversationFoundMessage:L,allowGuestUsers:!1};function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}pt=Object(y.connect)((function(e,t){var n=e.message,r=e.conversation,a=e.client;return ut(ut(ut(ut({},n),r),a),{},{ownProps:t})}),{getMessageList:function(e){return function(t){return t({type:"LOADING_MESSAGE_LIST",payload:{}}),e.list((function(e,n){t(e?{type:"MESSAGE_LIST_FAIL",payload:e}:{type:"MESSAGE_LIST_SUCCESS",payload:n.reverse()})}))}},sendMessageToConversation:function(e,t){return function(n){n({type:"SENDING_MESSAGE",payload:t});var r={id:t.id,body:t.body,attachments:t.attachments?t.attachments:[]};return e.sendMessage(r,(function(e,t){if(e)return r.error=e,void n({type:"SEND_MESSAGE_FAIL",payload:r});n({type:"SEND_MESSAGE_SUCCESS",payload:t})}))}},sendMessageToUserId:function(e,t){return function(n){return n({type:"SENDING_MESSAGE",payload:t}),e.Message.sendMessage(t,(function(e,t){e&&n({type:"SEND_MESSAGE_FAIL",payload:e}),n({type:"SEND_MESSAGE_SUCCESS",payload:t})}))}},sendFileToConversation:function(e,t,n,r,a){return function(o){o({type:"SENDING_FILE",payload:r});var i="application"!==a;e.File.upload(n,a,i,(function(e,n){if(e)return r.error=e,void o({type:"SEND_FILE_FAIL",payload:r});var a={};return a.id=r.id,a.attachments=[n],t.sendMessage(a,(function(e,t){if(e)return a.error=e,void o({type:"SEND_FILE_FAIL",payload:a});o({type:"SEND_FILE_SUCCESS",payload:t})}))}))}},loadMoreMessagesAction:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_MESSAGES",payload:{}}),e.list((function(e,n){t(e?{type:"LOAD_MORE_MESSAGES_FAIL",payload:e}:{type:"LOAD_MORE_MESSAGES_SUCCESS",payload:n.reverse()})}))}},setActiveConversation:q,setActiveUserId:J,registerConversationEventHandlers:function(e){return function(t){e.__isWatching&&e.on("watcher.message.created",(function(e){t({type:"NEW_MESSAGE_RECEIVED_EVENT",payload:e})}))}},deleteMessagesForEveryone:function(e,t){return function(n){return n({type:"DELETING_MESSAGES_FOR_EVERYONE",payload:t}),e.Message.deleteMessagesForEveryone(t,(function(e,r){n(e?{type:"DELETE_MESSAGES_FOR_EVERYONE_FAIL",payload:e}:{type:"DELETE_MESSAGES_FOR_EVERYONE_SUCCESS",payload:t})}))}},deleteMessagesForMe:function(e,t){return function(n){return n({type:"DELETING_MESSAGES_FOR_ME",payload:t}),e.Message.deleteMessagesForMe(t,(function(e,r){n(e?{type:"DELETE_MESSAGES_FOR_ME_FAIL",payload:e}:{type:"DELETE_MESSAGES_FOR_ME_SUCCESS",payload:t})}))}},banConversationUsers:function(e,t,n){return function(r){return r({type:"BAN_CONVERSATION_USERS",payload:{}}),e.banUsers(t,null,null,(function(a,o){a&&r({type:"BAN_CONVERSATION_USERS_FAIL",payload:a}),r({type:"BAN_CONVERSATION_USERS_SUCCESS",payload:{conversation:e,userIds:t,displayName:n}})}))}},unbanConversationUsers:function(e,t){return function(n){return n({type:"UNBAN_CONVERSATION_USERS",payload:{}}),e.unbanUsers(t,(function(r,a){r&&n({type:"UNBAN_CONVERSATION_USERS_FAIL",payload:r}),n({type:"UNBAN_CONVERSATION_USERS_SUCCESS",payload:{conversation:e,userIds:t}})}))}},startWatchingAndSetActiveConversation:function(e){return function(t){return t({type:"START_WATCHING_PROGRESS",payload:{}}),e.startWatching((function(n,r){n?t({type:"START_WATCHING_FAIL",payload:n}):(t({type:"START_WATCHING_SUCCESS",payload:r}),t({type:"SET_ACTIVE_CONVERSATION",payload:e}))}))}},stopWatchingAndSetNullConversation:function(e){return function(t){return t({type:"STOP_WATCHING_PROGRESS",payload:{}}),e.stopWatching((function(e,n){e?t({type:"STOP_WATCHING_FAIL",payload:e}):(t({type:"STOP_WATCHING_SUCCESS",payload:n}),t({type:"SET_ACTIVE_CONVERSATION",payload:null}))}))}},getConversationBanList:function(e){return function(t){return t({type:"LOADING_CONVERSATION_BAN_LIST",payload:{}}),e.list((function(e,n){e&&t({type:"CONVERSATION_BAN_LIST_FAIL",payload:e}),t({type:"CONVERSATION_BAN_LIST_SUCCESS",payload:n})}))}}})(pt);var ft=function(e){u()(n,e);var t=mt(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"toggleMoreOptions",(function(){r.setState((function(e){return{showMoreOptions:!e.showMoreOptions}}))})),v()(c()(r),"hideMoreOptions",(function(){r.state.showMoreOptions&&r.setState((function(e){return{showMoreOptions:!1}}))})),r.state={showMoreOptions:!1},r}return i()(n,[{key:"showImage",value:function(e){var t=document.createElement("a");t.href=e,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"downloadFile",value:function(e,t){var n=document.createElement("a");n.href=e,n.target="_blank",n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"render",value:function(){var e,t=this,n=this.props,r=(n.client,n.message),a=n.isSentByAdmin,o=n.renderMoreOptions,i=this.state.showMoreOptions,s="admin"===r.type;return r.attachments&&r.attachments.length&&(e=r.attachments.map((function(e){switch(e.type){case"image":return E.a.createElement("img",{className:"ch-image-message",src:e.thumbnailUrl?e.thumbnailUrl:e.fileUr,onClick:function(){return t.showImage(e.fileUrl)}});case"video":return E.a.createElement("div",{className:"ch-video-container"},E.a.createElement("img",{className:"ch-image-message",src:e.thumbnailUrl,onClick:function(){return t.showImage(e.fileUrl)}}),E.a.createElement("i",{className:"material-icons ch-video-play-icon"},"play_circle_outline"));case"application":return E.a.createElement("div",{className:"ch-text-message"},E.a.createElement("div",{className:"ch-message-body"},E.a.createElement("div",{className:"ch-docs-data"},E.a.createElement("i",{className:"material-icons ch-attachment-icon"},"description"),E.a.createElement("span",{className:"ch-docs-name"},e.name),E.a.createElement("i",{className:"material-icons ch-docs-download-icon",onClick:function(){return t.downloadFile(e.fileUrl,e.name)}},"arrow_downward")),E.a.createElement("div",{className:"ch-docs-details"},E.a.createElement("hr",null),E.a.createElement("span",null,e.extension))));default:return null}}))),E.a.createElement(E.a.Fragment,null,r.showDateSeparator&&E.a.createElement("div",{key:"".concat(r.id,"-date"),className:"ch-msg-padding"},E.a.createElement("div",{className:"ch-message-date-separator"},E.a.createElement("div",{className:"message-date-separator_left"}),E.a.createElement("div",{className:"message-date-separator_text"},be(r.createdAt)),E.a.createElement("div",{className:"message-date-separator_right"}))),s?E.a.createElement("div",{className:"ch-admin-msg-container"},E.a.createElement("span",{className:"ch-admin-msg"},r.text)):E.a.createElement("div",{key:r.id,className:"ch-msg-padding ".concat("left")},E.a.createElement("div",{className:"ch-msg-container ch-msg-container-livestream"},E.a.createElement(le,{src:r.owner.profileImageUrl,initials:r.owner.displayName,className:"ch-message-owner-avatar"}),E.a.createElement("div",{className:"ch-msg-content ch-msg-content__livestream"},r.body&&E.a.createElement("div",{className:"ch-text-message"},E.a.createElement("div",{className:"ch-message-owner-name"},r.owner.displayName,a&&E.a.createElement("span",null," (",T,")")),r.body),e),E.a.createElement("div",{className:"ch-msg-more-icon"},E.a.createElement("i",{className:"material-icons",onClick:function(){return t.toggleMoreOptions()}},"more_vert")),E.a.createElement($e,{onOutsideClick:function(){return t.hideMoreOptions()}},E.a.createElement("div",{onClick:function(){return t.toggleMoreOptions()}},i&&o&&o())))))}}]),n}(g.Component);function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}ft=X(ft);var Et=function(e){u()(n,e);var t=gt(n);function n(e){var r;return a()(this,n),r=t.call(this,e),v()(c()(r),"_init",(function(){var e=r.props.client.User.createUserListQuery();e.limit=r.friendsLimit,e.skip=0,e.sort="isOnline DESC, displayName ASC ",r.props.getFriendsList(e)})),v()(c()(r),"_searchOnServer",(function(e){var t=r.props.client,n=t.User.createUserListQuery();n.limit=r.searchLimit,n.skip=0,n.search=e,n.sort="isOnline DESC, displayName ASC",r.props.searchFriendsAction(n);var a=t.User.createUserListQuery();a.limit=r.searchLimit,a.skip=0,a.search=e,a.sort="isOnline DESC, displayName ASC",r.props.getMoreUsersList(a)})),v()(c()(r),"clearSearch",(function(){r.setState({searchText:""})})),v()(c()(r),"onContactClick",(function(e){var t=r.props.onContactClick;r.props.setActiveUserId(e),t&&"function"==typeof t&&t(e)})),r.searchLimit=10,r.friendsLimit=50,r.state={searchText:""},r.handleChange=r.handleChange.bind(c()(r)),r._searchOnServer=ct()(r._searchOnServer,800),r}return i()(n,[{key:"componentDidMount",value:function(){this.props.connected&&this._init()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=(t.client,t.connected);n&&!e.connected&&n&&this._init()}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({searchText:t}),t&&this._searchOnServer(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.connecting,r=t.connected,a=t.loadingFriendsList,o=t.loadingSearchFriends,i=t.friendslist,s=t.moreUsersList,c=t.searchFriends,l=t.showArrowBack,u=t.onBack,d=this.state.searchText,p=i;d?p=c:s=[];var m=!!s.length;return E.a.createElement("div",{id:"ch_search_window",className:"ch-search-window"},E.a.createElement(de,{showArrowBack:l,onBack:u,title:A}),E.a.createElement("div",{id:"ch_search_box",className:"ch-search-box"},E.a.createElement("input",{placeholder:"Search",id:"ch_search_input_box",className:"ch-search-input-box",value:d,onChange:this.handleChange}),d&&E.a.createElement("i",{id:"ch_clear_search_icon",className:"material-icons ch-clear-search-icon",onClick:this.clearSearch},"close")),E.a.createElement("div",{id:"ch_friends_box",className:"ch-friends-box"},(n||a)&&E.a.createElement("div",{className:"center"},E.a.createElement(me,null)),o&&E.a.createElement("div",null,E.a.createElement(me,null)),r&&d&&!p.length&&!m&&!a&&!o&&E.a.createElement("div",{className:"center no-record-found"},"No Record Found"),E.a.createElement("div",{id:"ch_suggested_box"},!d&&!a&&E.a.createElement("div",{id:"ch_suggested",className:"ch-suggested"},M),p.map((function(t){return E.a.createElement("li",{key:t.id,id:t.id,className:"ch-friends-list",onClick:function(){return e.onContactClick(t.id)}},E.a.createElement(le,{src:t.profileImageUrl,initials:t.displayName,className:"ch-contact-img"},t.isOnline&&E.a.createElement("span",{className:"ch-online-icon ch-show-element"})),E.a.createElement("div",{id:"ch_friend_name",className:"ch-friend-name"},t.displayName))}))),m&&E.a.createElement("div",{id:"ch_users_box"},E.a.createElement("div",{id:"ch_more_users",className:"ch-more-users"},I),s.map((function(t){return E.a.createElement("li",{key:t.id,id:t.id,className:"ch-friends-list",onClick:function(){return e.onContactClick(t.id)}},E.a.createElement(le,{src:t.profileImageUrl,initials:t.displayName,className:"ch-contact-img"},t.isOnline&&E.a.createElement("span",{className:"ch-online-icon ch-show-element"})),E.a.createElement("div",{id:"ch_friend_name",className:"ch-friend-name"},t.displayName))})))))}}]),n}(g.PureComponent);Et=X(Et);Et=Object(y.connect)((function(e){var t=e.user,n=e.client;return vt(vt({},t),n)}),{getFriendsList:function(e){return function(t){return t({type:"LOADING_FRIENDS_LIST",payload:{}}),e.friendsList((function(e,n){e&&t({type:"FRIENDS_LIST_FAIL",payload:e}),t({type:"FRIENDS_LIST_SUCCESS",payload:n})}))}},loadMoreFriends:function(e){return function(t){return t({type:"LOADING_LOAD_MORE_FRIENDS",payload:{}}),e.friendsList((function(e,n){e&&t({type:"LOAD_MORE_FRIENDS_FAIL",payload:e}),t({type:"LOAD_MORE_FRIENDS_SUCCESS",payload:n})}))}},getMoreUsersList:function(e){return function(t){return t({type:"LOADING_MORE_USERS_LIST",payload:{}}),e.usersList((function(e,n){e&&t({type:"MORE_USERS_LIST_FAIL",payload:e}),t({type:"MORE_USERS_LIST_SUCCESS",payload:n})}))}},searchFriendsAction:function(e){return function(t){return t({type:"LOADING_SEARCH_FRIENDS",payload:{}}),e.friendsList((function(e,n){e&&t({type:"SEARCH_FRIENDS_FAIL",payload:e}),t({type:"SEARCH_FRIENDS_SUCCESS",payload:n})}))}},setActiveUserId:J})(Et);var yt=n(12),St=n(21),_t=n.n(St);n(23),n(24);function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot,bt,At={connecting:!1,connected:!1,error:null},Mt=n(8),It=n.n(Mt),Rt=Ee({conversationlist:[],conversationLoading:!1,loadingMoreConversations:!1,allConversationsLoaded:!1,conversationError:null,banList:[]},(Ot={},v()(Ot,"LOADING_CONVERSATION_LIST",(function(e,t){e.conversationLoading=!0})),v()(Ot,"CONVERSATION_LIST_FAIL",(function(e,t){e.conversationLoading=!1,e.conversationError=t.payload})),v()(Ot,"CONVERSATION_LIST_SUCCESS",(function(e,t){e.conversationLoading=!1,e.conversationlist=t.payload})),v()(Ot,"LOADING_LOAD_MORE_CONVERSATIONS",(function(e,t){e.loadingMoreConversations=!0})),v()(Ot,"LOAD_MORE_CONVERSATIONS_FAIL",(function(e,t){e.loadingMoreConversations=!1,e.conversationError=t.payload})),v()(Ot,"LOAD_MORE_CONVERSATIONS_SUCCESS",(function(e,t){e.loadingMoreConversations=!1,t.payload.length?(e.conversationlist=[].concat(It()(e.conversationlist),It()(t.payload)),e.conversationlist=ye(e.conversationlist)):e.allConversationsLoaded=!0})),v()(Ot,"USER_STATUS_UPDATED",(function(e,t){var n=t.payload.user,r=e.conversationlist.map((function(e,t){return e.isGroup||e.user.id!=n.id||(e.user.isOnline=n.isOnline,e.user.lastSeen=n.lastSeen),e}));e.conversationlist=r})),v()(Ot,"NEW_MESSAGE_RECEIVED_EVENT",(function(e,t){var n,r,a=t.payload.message,o=e.conversationlist.map((function(e,o){return e.id==a.conversationId?(e.lastMessage=a,e.updatedAt=t.payload.timestamp,n=o,r=e,e):e}));n>0&&(o.splice(n,1),o.unshift(r)),e.conversationlist=o})),v()(Ot,"USER_JOINED_EVENT",(function(e,t){var n=t.payload.conversation;e.conversationlist=[n].concat(It()(e.conversationlist)),e.conversationlist=ye(e.conversationlist)})),v()(Ot,"MEMBERS_ADDED_EVENT",(function(e,t){var n,r,a=t.payload,o=a.conversation,i=a.members,s=a.timestamp,c=e.conversationlist.map((function(e,t){return e.id==o.id?(e.memberCount=o.memberCount,e.updatedAt=s,e.members=e.members.concat(i),n=t,r=e,e):e}));n>0&&(c.splice(n,1),c.unshift(r)),e.conversationlist=c})),v()(Ot,"MEMBERS_REMOVED_EVENT",(function(e,t){var n,r,a=t.payload,o=a.conversation,i=a.members,s=a.timestamp,c=e.conversationlist.map((function(e,t){return e.id==o.id?(e.memberCount=o.memberCount,e.updatedAt=s,i.forEach((function(t){var n=e.members.findIndex((function(e){return e.userId==t.id}));n>=0&&e.members.splice(n,1)})),n=t,r=e,e):e}));n>0&&(c.splice(n,1),c.unshift(r)),e.conversationlist=c})),v()(Ot,"CONVERSATION_UPDATED_EVENT",(function(e,t){var n,r,a=t.payload.conversation,o=e.conversationlist.map((function(e,o){return e.id==a.id?(e.title=a.title,e.profileImageUrl=a.profileImageUrl,e.updatedAt=t.payload.timestamp,n=o,r=e,e):e}));n>0&&(o.splice(n,1),o.unshift(r)),e.conversationlist=o})),v()(Ot,"USER_UPDATED_EVENT",(function(e,t){var n=t.payload.user,r=e.conversationlist.map((function(e,t){return e.isGroup||e.user.id!=n.id||(e.user.isOnline=n.isOnline,e.user.lastSeen=n.lastSeen,e.user.displayName=n.displayName,e.user.profileImageUrl=n.profileImageUrl),e}));e.conversationlist=r})),v()(Ot,"MARK_AS_READ_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.user,o=n.timestamp,i=e.conversationlist.map((function(e,t){return e.id==r.id?(e.lastReadAt[a.id]&&(e.lastReadAt[a.id]=o),e):e}));e.conversationlist=i})),v()(Ot,"DELETE_MESSAGE_FOR_EVERYONE_EVENT",(function(e,t){var n=t.payload.messages,r=e.conversationlist.map((function(e){return e.id==t.payload.conversation.id&&e.lastMessage&&n.map((function(e){return e.id})).includes(e.lastMessage.id)?(e.lastMessage.isDeleted=!0,e.lastMessage.body="",e.lastMessage.attachments=[],e.updatedAt=t.payload.timestamp,e):e}));e.conversationlist=r})),v()(Ot,"DELETE_MESSAGE_EVENT",(function(e,t){var n=t.payload.messages;e.conversationlist.map((function(r,a){r.id==t.payload.conversation.id&&r.lastMessage&&(n.map((function(e){return e.id})).includes(r.lastMessage.id)&&(e.conversationlist[a]=t.payload.conversation))}))})),v()(Ot,"CONVERSATION_BAN_LIST_SUCCESS",(function(e,t){e.banList=t.payload})),v()(Ot,"BAN_CONVERSATION_USERS_SUCCESS",(function(e,t){var n=t.payload,r=(n.conversation,n.userIds),a=n.displayName,o=r.map((function(e){return{userId:e,user:{displayName:a}}})),i=[].concat(It()(e.banList),It()(o));e.banList=i})),v()(Ot,"UNBAN_CONVERSATION_USERS_SUCCESS",(function(e,t){var n=t.payload,r=(n.conversation,n.userIds),a=[];e.banList.forEach((function(e){r.includes(e.userId)||a.push(e)})),e.banList=a})),Ot));function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt,Lt=window.Channelize,kt=Ee({messagelist:[],messageLoading:!1,messageError:null,loadingMoreMessages:!1,allMessagesLoaded:!1,sendingMessage:!1,typing:[],conversation:null,userId:null,newMessage:null,sendingFile:!1},(bt={},v()(bt,"LOADING_MESSAGE_LIST",(function(e,t){e.messageLoading=!0,e.messagelist=[],e.allMessagesLoaded=!1})),v()(bt,"MESSAGE_LIST_SUCCESS",(function(e,t){e.messageLoading=!1,e.messagelist=t.payload})),v()(bt,"MESSAGE_LIST_FAIL",(function(e,t){e.messageLoading=!1,e.messageError=t.payload})),v()(bt,"SENDING_MESSAGE",(function(e,t){e.sendingMessage=!0,t.payload.status="pending",e.messagelist=[].concat(It()(e.messagelist),[t.payload]),e.messagelist=ye(e.messagelist)})),v()(bt,"SEND_MESSAGE_SUCCESS",(function(e,t){e.sendingMessage=!1,e.messagelist=[].concat(It()(e.messagelist),[t.payload]),e.messagelist=ye(e.messagelist)})),v()(bt,"SEND_MESSAGE_FAIL",(function(e,t){t.payload.status="failed"})),v()(bt,"SENDING_FILE",(function(e,t){e.sendingFile=!0,e.messagelist=[].concat(It()(e.messagelist),[t.payload]),e.messagelist=ye(e.messagelist)})),v()(bt,"SEND_FILE_FAIL",(function(e,t){e.sendingFile=!1})),v()(bt,"SEND_FILE_SUCCESS",(function(e,t){e.sendingFile=!1,e.messagelist=[].concat(It()(e.messagelist),[t.payload]),e.messagelist=ye(e.messagelist)})),v()(bt,"LOADING_LOAD_MORE_MESSAGES",(function(e,t){e.loadingMoreMessages=!0})),v()(bt,"LOAD_MORE_MESSAGES_SUCCESS",(function(e,t){e.loadingMoreMessages=!1,t.payload.length?(e.messagelist=[].concat(It()(t.payload),It()(e.messagelist)),e.messagelist=ye(e.messagelist)):e.allMessagesLoaded=!0})),v()(bt,"LOAD_MORE_MESSAGES_FAIL",(function(e,t){e.loadingMoreMessages=!1,e.messageError=t.payload})),v()(bt,"SET_ACTIVE_CONVERSATION",(function(e,t){e.conversation=t.payload,e.userId=null})),v()(bt,"SET_ACTIVE_USERID",(function(e,t){e.userId=t.payload,e.conversation=null})),v()(bt,"CONVERSATION_UPDATED_EVENT",(function(e,t){var n=t.payload.conversation,r=n.id,a=n.title,o=n.profileImageUrl;if(e.conversation&&e.conversation.id==r){var i=Dt(Dt({},e.conversation.toJSON()),{},{title:a,profileImageUrl:o,updatedAt:t.payload.timestamp}),s=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(s,i)}})),v()(bt,"MEMBERS_ADDED_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.members,o=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var i=e.conversation.toJSON();i.members=i.members.concat(a),i.memberCount=r.memberCount,i.updatedAt=o;var s=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(s,i)}})),v()(bt,"MEMBERS_REMOVED_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.members,o=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var i=e.conversation.toJSON();i.memberCount=r.memberCount,i.updatedAt=o,a.forEach((function(e){var t=i.members.findIndex((function(t){return t.userId==e.id}));t>=0&&i.members.splice(t,1)}));var s=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(s,i)}})),v()(bt,"NEW_MESSAGE_RECEIVED_EVENT",(function(e,t){var n=t.payload.message;e.conversation&&e.conversation.id==n.conversationId&&(e.messagelist=[].concat(It()(e.messagelist),[n]),e.messagelist=ye(e.messagelist),e.newMessage=n)})),v()(bt,"USER_STATUS_UPDATED",(function(e,t){var n=t.payload.user;if(e.conversation&&!e.conversation.isGroup&&e.conversation.user.id==n.id){var r=e.conversation.toJSON();r.user.isOnline=n.isOnline,r.user.lastSeen=n.lastSeen;var a=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(a,r)}})),v()(bt,"USER_UPDATED_EVENT",(function(e,t){var n=t.payload.user;if(e.conversation&&!e.conversation.isGroup&&e.conversation.user.id==n.id){var r=e.conversation.toJSON();r.user.isOnline=n.isOnline,r.user.lastSeen=n.lastSeen,r.user.displayName=n.displayName,r.user.profileImageUrl=n.profileImageUrl;var a=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(a,r)}})),v()(bt,"MARK_AS_READ_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.user,o=n.timestamp;if(e.conversation&&e.conversation.id==r.id){var i=e.conversation.toJSON();i.lastReadAt[a.id]&&(i.lastReadAt[a.id]=o);var s=Lt.core.Client.getInstance();e.conversation=new Lt.core.Conversation.Model(s,i)}})),v()(bt,"TYPING_EVENT",(function(e,t){var n=t.payload,r=n.conversation,a=n.isTyping,o=n.user,i=e.conversation;if(i&&i.id==r.id){var s=e.typing.findIndex((function(e){return e.id==o.id}));a&&s<0?e.typing.push(o):!a&&s>=0&&e.typing.splice(s,1)}})),v()(bt,"DELETE_MESSAGE_FOR_EVERYONE_EVENT",(function(e,t){var n=t.payload.conversation,r=t.payload.messages;if(e.conversation&&e.conversation.id==n.id){var a=r.map((function(e){return e.id})),o=e.messagelist.map((function(e){return a.includes(e.id)?(e.isDeleted=!0,e.body="",e.attachments=[],e):e}));e.messagelist=o}})),v()(bt,"DELETE_MESSAGE_EVENT",(function(e,t){var n=t.payload.conversation,r=t.payload.messages;if(e.conversation&&e.conversation.id==n.id){var a=r.map((function(e){return e.id}));e.messagelist=It()(e.messagelist.filter((function(e){return!a.includes(e.id)})))}})),v()(bt,"DELETE_MESSAGES_FOR_EVERYONE_SUCCESS",(function(e,t){var n=t.payload,r=e.messagelist.map((function(e){return n.includes(e.id)?(e.isDeleted=!0,e.body="",e.attachments=[],e):e}));e.messagelist=r})),v()(bt,"DELETE_MESSAGES_FOR_ME_SUCCESS",(function(e,t){var n=t.payload;e.messagelist=It()(e.messagelist.filter((function(e){return!n.includes(e.id)})))})),v()(bt,"START_WATCHING_PROGRESS",(function(e,t){e.messageLoading=!0})),v()(bt,"START_WATCHING_FAIL",(function(e,t){e.messageLoading=!1,e.messageError=t.payload})),v()(bt,"START_WATCHING_SUCCESS",(function(e,t){e.messageLoading=!1})),v()(bt,"STOP_WATCHING_PROGRESS",(function(e,t){e.messageLoading=!0})),v()(bt,"STOP_WATCHING_FAIL",(function(e,t){e.messageLoading=!1,e.messageError=t.payload})),v()(bt,"STOP_WATCHING_SUCCESS",(function(e,t){e.messageLoading=!1})),v()(bt,"CONVERSATION_BAN_UPDATED_EVENT",(function(e,t){var n=t.payload.ban,r=Lt.core.Client.getInstance(),a=e.conversation.toJSON();a.ban=n,e.conversation=new Lt.core.Conversation.Model(r,a)})),bt)),Ut=Ee({friendslist:[],loadingFriendsList:!1,error:null,loadingMoreFriends:!1,allFriendsLoaded:!1,moreUsersList:[],loadingMoreUsersList:!1,searchFriends:[],loadingSearchFriends:!1},(Tt={},v()(Tt,"LOADING_FRIENDS_LIST",(function(e,t){e.loadingFriendsList=!0,e.allFriendsLoaded=!1,e.friendslist=[]})),v()(Tt,"FRIENDS_LIST_SUCCESS",(function(e,t){e.loadingFriendsList=!1,e.friendslist=t.payload})),v()(Tt,"FRIENDS_LIST_FAIL",(function(e,t){e.loadingFriendsList=!1,e.error=t.payload})),v()(Tt,"LOADING_LOAD_MORE_FRIENDS",(function(e,t){e.loadingMoreFriends=!0})),v()(Tt,"LOAD_MORE_FRIENDS_SUCCESS",(function(e,t){e.loadingMoreFriends=!1,t.payload.length?(e.friendslist=[].concat(It()(e.friendslist),It()(t.payload)),e.friendslist=ye(e.friendslist)):e.allFriendsLoaded=!0})),v()(Tt,"LOAD_MORE_FRIENDS_FAIL",(function(e,t){e.loadingMoreFriends=!1,e.error=t.payload})),v()(Tt,"LOADING_MORE_USERS_LIST",(function(e,t){e.loadingMoreUsersList=!0,e.moreUsersList=[]})),v()(Tt,"MORE_USERS_LIST_SUCCESS",(function(e,t){e.loadingMoreUsersList=!1,e.moreUsersList=t.payload})),v()(Tt,"MORE_USERS_LIST_FAIL",(function(e,t){e.loadingMoreUsersList=!1,e.error=t.payload})),v()(Tt,"LOADING_SEARCH_FRIENDS",(function(e,t){e.loadingSearchFriends=!0,e.searchFriends=[]})),v()(Tt,"SEARCH_FRIENDS_SUCCESS",(function(e,t){e.loadingSearchFriends=!1,e.searchFriends=t.payload})),v()(Tt,"SEARCH_FRIENDS_FAIL",(function(e,t){e.loadingSearchFriends=!1,e.error=t.payload})),Tt)),Ft=Object(yt.combineReducers)({client:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECTING":return Nt(Nt({},e),{},{connecting:!0});case"CONNECT_SUCCESS":return Nt(Nt({},e),{},{connected:!0,connecting:!1});case"CONNECT_FAIL":return Nt(Nt({},e),{},{connected:!1,error:t.payload,connecting:!1});case"DISCONNECT_SUCCESS":return Nt(Nt({},e),{},{connected:!1});case"DISCONNECT_FAIL":return Nt(Nt({},e),{},{connected:!0,error:t.payload});default:return e}},conversation:Rt,message:kt,user:Ut}),xt=[_t.a];var Pt=yt.compose.apply(void 0,[yt.applyMiddleware.apply(void 0,xt)].concat([])),jt=Object(yt.createStore)(Ft,{},Pt);n.d(t,"App",(function(){return te})),n.d(t,"Header",(function(){return de})),n.d(t,"Launcher",(function(){return pe})),n.d(t,"Loader",(function(){return me})),n.d(t,"ConversationList",(function(){return Ge})),n.d(t,"ConversationItem",(function(){return Fe})),n.d(t,"ConversationWindow",(function(){return pt})),n.d(t,"MessageSimple",(function(){return tt})),n.d(t,"MessageLivestream",(function(){return ft})),n.d(t,"SearchWindow",(function(){return Et})),n.d(t,"OutsideClickHandler",(function(){return $e})),n.d(t,"Avatar",(function(){return le})),n.d(t,"GuestJoinForm",(function(){return Ke})),n.d(t,"createReducer",(function(){return Ee})),n.d(t,"uniqueList",(function(){return ye})),n.d(t,"modifyConversation",(function(){return Se})),n.d(t,"modifyMessageList",(function(){return _e})),n.d(t,"getLastMessageString",(function(){return Ce})),n.d(t,"lastMessageTimeParser",(function(){return Ne})),n.d(t,"AMorPMTimeParser",(function(){return Oe})),n.d(t,"dateSeparatorParser",(function(){return be})),n.d(t,"isSameDay",(function(){return Ae})),n.d(t,"typingString",(function(){return Me})),n.d(t,"isSameUser",(function(){return Ie})),n.d(t,"capitalize",(function(){return Re})),n.d(t,"getCookie",(function(){return De})),n.d(t,"setCookie",(function(){return Te})),n.d(t,"ChannelizeContext",(function(){return z})),n.d(t,"ChannelizeProvider",(function(){return Q})),n.d(t,"withChannelizeContext",(function(){return X})),n.d(t,"store",(function(){return jt}))}]);
//# sourceMappingURL=index.js.map